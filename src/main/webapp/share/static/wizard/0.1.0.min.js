require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"wizard":[function(require,module,exports){
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
/**
 * 声明哈希表接口规范。
 *
 * @author    姚尧 <yaogaoyu@163.com>
 * @license   GPL-3.0
 * @file      Util/IHashTable.ts
 */
/**
 * 声明视图状态接口规范。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      Core/_View/IState.ts
 */
/// <reference path="../../Util/IHashTable.ts" />
/**
 * 声明视图属性接口规范。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      Core/_View/IProps.ts
 */
/// <reference path="../../Util/IHashTable.ts" />
/// <reference path="../_Runtime/IFlow.ts" />
/**
 * 声明视图规范。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      Core/_View/IView.ts
 */
/// <reference path="../../Util/IHashTable.ts" />
/// <reference path="../../../include/react/react-global.d.ts" />
/// <reference path="IState.ts" />
/// <reference path="IProps.ts" />
/// <reference path="../_Runtime/IFlow.ts" />
/**
 * 声明（运行时）事件元信息接口规范。
 *
 * @author    郑煜宇 <yzheng@atfacg.com>
 * @copyright © 2015 Dahao.de
 * @license   GPL-3.0
 * @file      Core/_Ev/IEventMetas.ts
 */
/**
 * 声明（运行时）事件接口规范。
 *
 * @author    郑煜宇 <yzheng@atfacg.com>
 * @copyright © 2015 Dahao.de
 * @license   GPL-3.0
 * @file      Core/_Ev/IEvent.ts
 */
/// <reference path="IEventMetas.ts" />
/**
 * 声明（运行时）事件监听函数接口规范。
 *
 * @author    郑煜宇 <yzheng@atfacg.com>
 * @copyright © 2015 Dahao.de
 * @license   GPL-3.0
 * @file      Core/_Ev/IEventListener.ts
 */
/// <reference path="IEvent.ts" />
/**
 * 声明（运行时）事件宿主接口规范。
 *
 * @author    郑煜宇 <yzheng@atfacg.com>
 * @copyright © 2015 Dahao.de
 * @license   GPL-3.0
 * @file      Core/_Ev/IEmittable.ts
 */
/// <reference path="IEventListener.ts" />
/**
 * 声明（运行时）业务逻辑流接口规范。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      Core/_Runtime/IFlow.ts
 */
/// <reference path="../_View/IView.ts" />
/// <reference path="../_Ev/IEmittable.ts" />
/**
 * 声明数组遍历函数接口规范。
 *
 * @author    姚尧 <yaogaoyu@163.com>
 * @license   GPL-3.0
 * @file      Util/IArrayIterator.ts
 */
/**
 * 声明对象遍历函数接口规范。
 *
 * @author    姚尧 <yaogaoyu@163.com>
 * @license   GPL-3.0
 * @file      Util/IObjectIterator.ts
 */
/// <reference path="IHashTable.ts" />
/**
 * 定义数组类工具方法。
 *
 * @author    姚尧 <yaogaoyu@163.com>
 * @license   GPL-3.0
 * @file      Util/_iterator.ts
 */
/// <reference path="IArrayIterator.ts" />
/// <reference path="IObjectIterator.ts" />
var Util;
(function (Util) {
    function each(obj, cb, $this) {
        $this = $this || {};
        var ii;
        if (obj instanceof Array) {
            if (obj.forEach)
                return obj.forEach(cb, $this);
            for (ii = 0; ii < obj.length; ii++)
                cb.call($this, obj[ii], ii, obj);
            return;
        }
        for (ii in obj)
            if (obj.hasOwnProperty(ii))
                cb.call($this, obj[ii], ii, obj);
    }
    Util.each = each;
    function every(obj, cb, $this) {
        $this = $this || {};
        var ii;
        if (obj instanceof Array) {
            if (obj.every)
                return obj.every(cb, $this);
            for (ii = 0; ii < obj.length; ii++)
                if (!cb.call($this, obj[ii], ii, obj))
                    return false;
        }
        else
            for (ii in obj)
                if (obj.hasOwnProperty(ii) && !cb.call($this, obj[ii], ii, obj))
                    return false;
        return true;
    }
    Util.every = every;
    function some(obj, cb, $this) {
        $this = $this || {};
        var ii;
        if (obj instanceof Array) {
            if (obj.some)
                return obj.some(cb, $this);
            for (ii = 0; ii < obj.length; ii++)
                if (cb.call($this, obj[ii], ii, obj))
                    return true;
        }
        else
            for (ii in obj)
                if (obj.hasOwnProperty(ii) && cb.call($this, obj[ii], ii, obj))
                    return true;
        return false;
    }
    Util.some = some;
    function indexOf(obj, item, offset) {
        if (offset === void 0) { offset = 0; }
        var ii;
        if (obj instanceof Array) {
            if (obj.indexOf)
                return obj.indexOf(item, offset);
            for (ii = offset; ii < obj.length; ii++)
                if (obj[ii] == item)
                    return ii;
        }
        else
            for (ii in obj)
                if (obj.hasOwnProperty(ii) && obj[ii] == item)
                    return ii;
        return -1;
    }
    Util.indexOf = indexOf;
    function clone(orig) {
        if ('object' != typeof orig)
            return orig;
        if (orig instanceof Array)
            return orig.slice(0);
        var dolly = {};
        Util.each(orig, function (value, key) {
            dolly[key] = value;
        });
        return dolly;
    }
    Util.clone = clone;
})(Util || (Util = {}));
/**
 * 定义（运行时）业务逻辑流组件。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      Runtime/Flow.ts
 */
/// <reference path="../Core/_Runtime/IFlow.ts" />
/// <reference path="../Util/_iterator.ts" />
var Runtime;
(function (Runtime) {
    var Flow = (function () {
        /**
         * 构造函数。
         */
        function Flow() {
            this.listeners = {};
        }
        /**
         * 获取绑定视图。
         */
        Flow.prototype.gView = function () {
            return this.view;
        };
        /**
         * 设置绑定视图。
         */
        Flow.prototype.sView = function (view) {
            this.view = view;
            return this;
        };
        /**
         * 新增事件监听。
         */
        Flow.prototype.addEventListener = function (type, listener) {
            this.listeners[type] = this.listeners[type] || [];
            var pos = Util.indexOf(this.listeners[type], listener);
            if (-1 == pos)
                this.listeners[type].push(listener);
            return this;
        };
        /**
         * 取消事件监听。
         */
        Flow.prototype.removeEventListener = function (type, listener) {
            this.listeners[type] = this.listeners[type] || [];
            var pos = Util.indexOf(this.listeners[type], listener);
            if (-1 != pos)
                this.listeners[type].splice(pos, 1);
            return this;
        };
        /**
         * 发生事件。
         */
        Flow.prototype.dispatchEvent = function (event) {
            Util.each(this.listeners[event.gType()] || [], function (listener) {
                listener(event);
            });
            return this;
        };
        return Flow;
    }());
    Runtime.Flow = Flow;
})(Runtime || (Runtime = {}));
/**
 * 定义视图抽象组件。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      View/View.ts
 */
/// <reference path="../../include/tsd.d.ts" />
/// <reference path="../Core/_View/IView.ts" />
var View;
(function (View_1) {
    var View = (function (_super) {
        __extends(View, _super);
        function View() {
            _super.apply(this, arguments);
        }
        return View;
    }(React.Component));
    View_1.View = View;
})(View || (View = {}));
/**
 * 定义Path信息组件。
 *
 * @author    姚尧 <yaogaoyu@163.com>
 * @license   GPL-3.0
 * @file      Util/Path.ts
 */
var Util;
(function (Util) {
    var Path;
    (function (Path) {
        /**
         * 获取指定部署根目录。
         */
        function gOrigin() {
            var origin = window.location.origin;
            var pathname = window.location.pathname;
            var root = pathname.match(/.*\//)[0];
            return origin + root;
        }
        Path.gOrigin = gOrigin;
    })(Path = Util.Path || (Util.Path = {}));
})(Util || (Util = {}));
/**
 * 配置向导-节点类型选择主视图。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      View/NodeChoice.ts
 */
/// <reference path="../View.ts" />
/// <reference path="../../Util/Path.ts" />
var View;
(function (View) {
    var NodeChoice = (function (_super) {
        __extends(NodeChoice, _super);
        function NodeChoice(props) {
            _super.call(this, props);
            this.origin = Util.Path.gOrigin();
            this.props.flow.sView(this);
        }
        NodeChoice.prototype.render = function () {
            var _this = this;
            return React.createElement("div", {className: 'wrap'}, React.createElement("div", {className: 'title'}, "步骤一：节点类型选择"), React.createElement("div", {className: 'desc'}, "选择一个进行同步服务的节点类型"), React.createElement("div", {className: 'formWrap'}, React.createElement("div", {className: 'nodeType'}, React.createElement("span", {className: 'inline type'}, React.createElement("span", {className: 'ibtn typeBtn' + (this.props.config['type'] == 'master' ? ' selected' : ''), onClick: function (evt) { _this.choice(evt, 'master'); }}, React.createElement("img", {src: this.origin + 's/images/node.png'}))), React.createElement("span", {className: 'inline type typeName'}, "Master"), React.createElement("span", {className: 'inline type desc'}, "主库节点，每个注册到此主节点上的从库节点将使用主库节点提供的服务进行数据同步。")), React.createElement("div", {className: 'nodeType'}, React.createElement("span", {className: 'inline type'}, React.createElement("span", {className: 'ibtn typeBtn' + (this.props.config['type'] == 'slaver' ? ' selected' : ''), onClick: function (evt) { _this.choice(evt, 'slaver'); }}, React.createElement("img", {src: this.origin + 's/images/node.png'}))), React.createElement("span", {className: 'inline type typeName'}, "Slaver"), React.createElement("span", {className: 'inline type desc'}, "从库节点，连接主库节点，与所有注册在主库节点上的从库节点进行数据同步。"))));
        };
        NodeChoice.prototype.choice = function (ev, type) {
            if (!type)
                return;
            this.props.flow.choiceType(type);
            this.forceUpdate();
            // 发送事件到stage进行下一个步骤
        };
        return NodeChoice;
    }(View.View));
    View.NodeChoice = NodeChoice;
})(View || (View = {}));
/**
 * 配置向导-数据库配置主视图。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      View/ConfigDB.ts
 */
/// <reference path="../View.ts" />
var View;
(function (View) {
    var ConfigDB = (function (_super) {
        __extends(ConfigDB, _super);
        function ConfigDB(props) {
            var _this = this;
            _super.call(this, props);
            this.dbOptions = [];
            this.props.flow.sView(this);
            Util.each(this.props.flow.getDatabases(), function (info, dbName) {
                _this.dbOptions.push(React.createElement("option", {value: dbName}, dbName));
            });
        }
        ConfigDB.prototype.render = function () {
            var _this = this;
            return React.createElement("div", {className: 'wrap'}, React.createElement("div", {className: 'title'}, "步骤二：数据库连接配置"), React.createElement("div", {className: 'desc'}, "数据库配置完成后请先测试连接，测试成功才能进行下一步。"), React.createElement("div", {className: 'formWrap'}, React.createElement("div", {className: 'row'}, React.createElement("div", {className: 'title'}, "数据库"), React.createElement("div", {className: 'input'}, React.createElement("select", {className: 'sel dbType', onChange: function (ev) { _this.dbTypeChange(ev); }, value: this.props.config["db.type"]}, React.createElement("option", {value: "-1"}, "请选择数据库"), this.dbOptions))), React.createElement("div", {className: 'row'}, React.createElement("div", {className: 'title'}, "数据库连接"), React.createElement("div", {className: 'input'}, React.createElement("input", {type: 'text', className: 'text dbInput', value: this.props.config["db.url"], onChange: function (ev) { _this.props.config["db.url"] = event.target.value; _this.forceUpdate(); }}))), React.createElement("div", {className: 'row'}, React.createElement("div", {className: 'title'}, "用户名"), React.createElement("div", {className: 'input'}, React.createElement("input", {type: 'text', className: 'text dbUser', value: this.props.config["db.user"], onChange: function (ev) { _this.props.config["db.user"] = event.target.value; _this.forceUpdate(); }}))), React.createElement("div", {className: 'row'}, React.createElement("div", {className: 'title'}, "密码"), React.createElement("div", {className: 'input'}, React.createElement("input", {type: 'password', className: 'text dbPsw', value: this.props.config["db.psw"], onChange: function (ev) { _this.props.config["db.psw"] = event.target.value; _this.forceUpdate(); }})))));
        };
        ConfigDB.prototype.dbTypeChange = function (ev) {
            var dbType = event.target.value;
            if (dbType == "-1") {
                this.props.config["db.type"] = "";
                this.props.config["db.driver"] = "";
                this.props.config["db.url"] = "";
            }
            else {
                this.props.config["db.type"] = dbType;
                this.props.config["db.driver"] = this.props.flow.getDatabases()[dbType]["driver"];
                this.props.config["db.url"] = this.props.flow.getDatabases()[dbType]["url"];
            }
            this.props.config["db.user"] = "";
            this.props.config["db.psw"] = "";
            this.forceUpdate();
        };
        return ConfigDB;
    }(View.View));
    View.ConfigDB = ConfigDB;
})(View || (View = {}));
/**
 * 配置向导-节点注册主视图。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      View/RegisteInfo.ts
 */
/// <reference path="../View.ts" />
var View;
(function (View) {
    var RegisteInfo = (function (_super) {
        __extends(RegisteInfo, _super);
        function RegisteInfo(props) {
            _super.call(this, props);
            this.props.flow.sView(this);
        }
        RegisteInfo.prototype.render = function () {
            var _this = this;
            return React.createElement("div", {className: 'wrap'}, React.createElement("div", {className: 'title'}, "步骤三：节点注册信息"), this.props.config['type'] == 'master' ?
                React.createElement("div", {className: 'desc nodeDesc'}, "本节点设置为主库节点，连接到本节点的从库节点将使用此URL进行节点注册") :
                React.createElement("div", {className: 'desc nodeDesc'}, "本节点设置为从库节点，请填写主库节点的注册接口URL"), React.createElement("div", {className: 'formWrap'}, this.props.config['type'] == 'master' ?
                React.createElement("div", {className: 'row'}, React.createElement("div", {className: 'title'}, "下面的链接是注册接口URL，请设置到进行数据同步的从库节点中。"), React.createElement("div", {className: 'title important'}, this.props.flow.genSyncURL())) :
                React.createElement("div", {className: 'row'}, React.createElement("div", {className: 'title'}, "请填写主库节点发布的注册接口URL"), React.createElement("div", {className: 'input'}, React.createElement("input", {type: 'text', className: 'text url', value: this.props.config["registration.url"], onChange: function (ev) { _this.saveURL(ev.target.value); }})))));
        };
        RegisteInfo.prototype.saveURL = function (val) {
            this.props.flow.save(val);
            this.forceUpdate();
        };
        return RegisteInfo;
    }(View.View));
    View.RegisteInfo = RegisteInfo;
})(View || (View = {}));
/**
 * 配置向导-设置用户向导主视图。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      View/ConfigUser.ts
 */
/// <reference path="../View.ts" />
var View;
(function (View) {
    var ConfigUser = (function (_super) {
        __extends(ConfigUser, _super);
        function ConfigUser(props) {
            _super.call(this, props);
            this.props.flow.sView(this);
        }
        ConfigUser.prototype.render = function () {
            return React.createElement("div", {className: 'wrap'}, React.createElement("div", {className: 'title'}, "步骤四：注册登录用户"), React.createElement("div", {className: 'desc'}, "注册一个用户登录到本系统"), React.createElement("div", {className: 'formWrap'}, React.createElement("div", {className: 'row'}, React.createElement("div", {className: 'title'}, "用户名"), React.createElement("div", {className: 'input'}, React.createElement("input", {type: 'text', className: 'userName'}))), React.createElement("div", {className: 'row'}, React.createElement("div", {className: 'title'}, "密码"), React.createElement("div", {className: 'input'}, React.createElement("input", {type: 'password', className: 'userPsw'})))));
        };
        return ConfigUser;
    }(View.View));
    View.ConfigUser = ConfigUser;
})(View || (View = {}));
/**
 * 配置向导-完成向导主视图。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      View/Finish.ts
 */
/// <reference path="../View.ts" />
var View;
(function (View) {
    var Finish = (function (_super) {
        __extends(Finish, _super);
        function Finish(props) {
            _super.call(this, props);
            this.props.flow.sView(this);
        }
        Finish.prototype.render = function () {
            return React.createElement("div", {className: 'wrap'}, React.createElement("div", {className: 'title'}, "步骤五：完成"), React.createElement("div", {className: 'desc finishDesc'}, "恭喜您，配置完成，请点击完成按钮跳转到同步工具首页。"));
        };
        return Finish;
    }(View.View));
    View.Finish = Finish;
})(View || (View = {}));
/**
 * 配置向导引导主视图。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      View/Stage.ts
 */
/// <reference path="View.ts" />
/// <reference path="_Steps/NodeChoice.tsx" />
/// <reference path="_Steps/ConfigDB.tsx" />
/// <reference path="_Steps/RegisteInfo.tsx" />
/// <reference path="_Steps/ConfigUser.tsx" />
/// <reference path="_Steps/Finish.tsx" />
var View;
(function (View) {
    var Stage = (function (_super) {
        __extends(Stage, _super);
        function Stage(props) {
            _super.call(this, props);
            /**
             * 弹出框配置
             */
            this.alertConf = {
                cancel: false,
                title: '提示',
                okValue: '确定',
                ok: function () {
                    //
                }
            };
            /**
             * 提示框配置
             */
            this.promptConf = {
                cancel: false
            };
            this.props.flow.sView(this);
            var flow = this.props.flow;
            this.stepViews = [
                React.createElement(View.NodeChoice, {flow: flow.make('nodeChoice'), config: flow.gConfig()}),
                React.createElement(View.ConfigDB, {flow: flow.make('configDB'), parentFlow: flow, config: flow.gConfig()}),
                React.createElement(View.RegisteInfo, {flow: flow.make('registeInfo'), config: flow.gConfig()}),
                // <ConfigUser flow={flow.make('configUser')} config={flow.gConfig()}/>,
                // <ConfigUser flow={flow.make('configUser')} config={flow.gConfig()}/>,
                React.createElement(View.Finish, {flow: flow.make('finish'), parentFlow: flow, config: flow.gConfig()})
            ];
        }
        Stage.prototype.render = function () {
            var _this = this;
            var flow = this.props.flow;
            var previousStyle = 'btn stageBtn' + (flow.gStepIndex() <= 0 ? ' disabled' : '');
            return React.createElement("div", {className: 'stage'}, React.createElement("div", {className: 'phase top'}, React.createElement("span", {className: 'title'}, "同步工具配置向导")), React.createElement("div", {className: 'phase stageWrap'}, this.stepViews[flow.gStepIndex()]), React.createElement("div", {className: 'phase bottom'}, flow.gStepIndex() == 1 ?
                React.createElement("span", {className: 'left btnWrap'}, React.createElement("span", {className: 'btn stageBtn', onClick: function () { _this.testConn(); }}, React.createElement("p", null, "测试连接"))) :
                '', React.createElement("span", {className: 'right btnWrap'}, React.createElement("span", {className: previousStyle, onClick: function (ev) { flow.previous(ev); }}, React.createElement("p", null, "上一步")), flow.gStepIndex() >= this.stepViews.length - 1 ?
                React.createElement("span", {className: 'btn stageBtn', onClick: function (ev) { flow.make("finish").finish(); }}, React.createElement("p", null, "完成")) :
                React.createElement("span", {className: 'btn stageBtn', onClick: function (ev) { flow.next(ev); }}, React.createElement("p", null, "下一步")))));
        };
        /**
         * 测试数据库连接
         */
        Stage.prototype.testConn = function () {
            var alertDialog = dialog(this.alertConf);
            var dbType = this.props.flow.gConfig()['db.type'];
            var dbDriver = this.props.flow.gConfig()['db.driver'];
            var dbUrl = this.props.flow.gConfig()['db.url'];
            var dbUser = this.props.flow.gConfig()['db.user'];
            var dbPsw = this.props.flow.gConfig()['db.psw'];
            if (!dbType || !dbDriver || !dbUrl || !dbUser || !dbPsw) {
                alertDialog.content("<span class='alert'><span class='icon icon-notification'></span><span class='title'>请完成数据库配置</span>");
                alertDialog.showModal();
                return;
            }
            var prompt = dialog(this.promptConf);
            prompt.content("正在测试数据库连接，请稍候。");
            prompt.showModal();
            this.props.flow.connTest().then(function (isSuc) {
                prompt.close();
                if (!isSuc) {
                    alertDialog.content("<span class='alert'><span class='icon icon-notification'></span><span class='title'>连接失败</span>");
                }
                else {
                    alertDialog.content("<span class='alert'><span class='icon icon-notification'></span><span class='title'>连接成功</span>");
                }
                alertDialog.showModal();
            });
        };
        return Stage;
    }(View.View));
    View.Stage = Stage;
})(View || (View = {}));
/**
 * 定义编辑器异常。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      E.ts
 */
var E = (function (_super) {
    __extends(E, _super);
    /**
     * 构造函数。
     */
    function E(message) {
        _super.call(this);
        if ('captureStackTrace' in Error)
            Error['captureStackTrace'](this, E);
        this.name = 'Error';
        this.message = message;
    }
    E.UTIL_REMOTE_TIMEOUT = '远端请求超时';
    return E;
}(Error));
/**
 * 声明成功回调函数接口规范。
 *
 * @author    姚尧 <yaogaoyu@163.com>
 * @license   GPL-3.0
 * @file      Util/ISuccessCallback.ts
 */
/// <reference path="IHashTable.ts" />
/**
 * 声明失败回调函数接口规范。
 *
 * @author    姚尧 <yaogaoyu@163.com>
 * @copyright © 2015 Dahao.de
 * @license   GPL-3.0
 * @file      Util/IFailureCallback.ts
 */
/**
 * 定义远端通信组件。
 *
 * @author    姚尧 <yaogaoyu@163.com>
 * @license   GPL-3.0
 * @file      Util/Remote.ts
 */
/// <reference path="../E.ts" />
/// <reference path="ISuccessCallback.ts" />
/// <reference path="IFailureCallback.ts" />
/// <reference path="_iterator.ts" />
var Util;
(function (Util) {
    var xdrs = [];
    var Remote;
    (function (Remote) {
        /**
         * 格式化。
         */
        function format(url) {
            return location.protocol + url.replace(/^.+\/\//, '//').replace(/\?.*$/, '');
        }
        Remote.format = format;
        /**
         * HTTP GET 远端数据。
         */
        function get(url, onSuccess, onFailure) {
            http(Method.GET, url, {}, onSuccess, onFailure);
        }
        Remote.get = get;
        /**
         * HTTP POST 远端数据。
         */
        function post(url, data, onSuccess, onFailure) {
            http(Method.POST, url, data, onSuccess, onFailure);
        }
        Remote.post = post;
        /**
         * HTTP 请求方法。
         */
        (function (Method) {
            Method[Method["GET"] = 0] = "GET";
            Method[Method["POST"] = 1] = "POST";
        })(Remote.Method || (Remote.Method = {}));
        var Method = Remote.Method;
        ;
        /**
         * HTTP 请求远端数据。
         */
        function http(method, url, data, onSuccess, onFailure) {
            var qs = [], xhr;
            if ('undefined' != typeof XDomainRequest) {
                xhr = new XDomainRequest();
                xdrs.push(xhr);
            }
            else
                xhr = new XMLHttpRequest();
            xhr.onload = function () {
                try {
                    var resp = JSON.parse(xhr.responseText);
                    if ('reason' in resp)
                        throw new E(resp['reason']);
                    if ('status' in xhr && 200 != xhr.status)
                        throw new E(xhr.statusText);
                    onSuccess(resp);
                }
                catch (error) {
                    if ('context' in resp)
                        error["context"] = resp["context"];
                    onFailure(error, xhr.status);
                }
            };
            xhr.onprogress = function () {
                //
            };
            xhr.onerror = function (event) {
                onFailure(event.error);
            };
            xhr.ontimeout = function () {
                onFailure(new E(E.UTIL_REMOTE_TIMEOUT));
            };
            // xhr.timeout = 30000;
            xhr.open(Method.GET == method ? 'GET' : 'POST', format(url), true);
            Util.each(data, function (value, key) {
                qs.push(key + '=' + encodeURIComponent(value));
            });
            if (qs.length && 'setRequestHeader' in xhr)
                xhr['setRequestHeader']('Content-Type', 'application/x-www-form-urlencoded');
            xhr.send(qs.length ? qs.join('&') : null);
        }
        Remote.http = http;
    })(Remote = Util.Remote || (Util.Remote = {}));
})(Util || (Util = {}));
/**
 * 声明引导程序业务流接口规范。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      Core/_Runtime/IStageFlow.ts
 */
/// <reference path="IFlow.ts" />
/// <reference path="../_View/IView.ts" />
/// <reference path="../../Util/Remote.ts" />
/**
 * 声明配置完成完成业务流接口规范。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      Core/_Runtime/IFinishFlow.ts
 */
/// <reference path="IFlow.ts" />
/// <reference path="../_View/IView.ts" />
/**
 * 声明节点类型选择业务流接口规范。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      Core/_Runtime/INodeChoiceFlow.ts
 */
/// <reference path="IStepFlow.ts" />
/// <reference path="../_View/IView.ts" />
/**
 * 节点类型选择实体。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      Runtime/NodeChoiceFlow.ts
 */
/// <reference path="../Flow.ts" />
/// <reference path="../../Core/_Runtime/INodeChoiceFlow.ts" />
var Runtime;
(function (Runtime) {
    var NodeChoiceFlow = (function (_super) {
        __extends(NodeChoiceFlow, _super);
        /**
         * 构造函数。
         */
        function NodeChoiceFlow(config) {
            _super.call(this);
            this.alertConf = {
                cancel: false,
                title: '提示',
                okValue: '确定',
                ok: function () {
                    //
                }
            };
            this.config = config;
        }
        /**
         * 节点类型选择业务
         */
        NodeChoiceFlow.prototype.choiceType = function (type) {
            this.config['type'] = type;
        };
        /**
         * 步骤验证
         */
        NodeChoiceFlow.prototype.validate = function () {
            if (!this.config['type']) {
                var alertDialog = dialog(this.alertConf);
                alertDialog.content("<span class='alert'><span class='icon icon-notification'></span><span class='title'>请选择一个节点类型。</span>");
                alertDialog.showModal();
                return false;
            }
            return true;
        };
        return NodeChoiceFlow;
    }(Runtime.Flow));
    Runtime.NodeChoiceFlow = NodeChoiceFlow;
})(Runtime || (Runtime = {}));
/**
 * 声明数据库配置业务流接口规范。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      Core/_Runtime/IConfigDBFlow.ts
 */
/// <reference path="IStepFlow.ts" />
/// <reference path="../_View/IView.ts" />
/**
 * 定义（运行时）事件组件。
 *
 * @author    郑煜宇 <yzheng@atfacg.com>
 * @copyright © 2015 Dahao.de
 * @license   GPL-3.0
 * @file      Ev/Event.ts
 */
/// <reference path="../Core/_Ev/IEvent.ts" />
/// <reference path="../Core/_Runtime/IFlow.ts" />
var Ev;
(function (Ev) {
    var Event = (function () {
        /**
         * 构造函数。
         */
        function Event(metas) {
            this.target = metas.target;
        }
        /**
         * 获取类型。
         */
        Event.prototype.gType = function () {
            return '';
        };
        return Event;
    }());
    Ev.Event = Event;
})(Ev || (Ev = {}));
/**
 * 声明（运行时）画面事件接口规范。
 *
 * @author    姚尧 <yyao@atfacg.com>
 * @copyright © 2015 Dahao.de
 * @license   GPL-3.0
 * @file      Ev/IControlMetas.ts
 */
/// <reference path="../Core/_Ev/IEventMetas.ts" />
/// <reference path="../Core/_Runtime/IStageFlow.ts" />
/**
 * 定义（运行时）画面出现选择信息事件组件。
 *
 * @author    姚尧 <yyao@atfacg.com>
 * @copyright © 2015 Dahao.de
 * @license   GPL-3.0
 * @file      Ev/Choice.ts
 */
/// <reference path="Event.ts" />
/// <reference path="IStepMetas.ts" />
var Ev;
(function (Ev) {
    var Step = (function (_super) {
        __extends(Step, _super);
        /**
         * 构造函数。
         */
        function Step(metas) {
            _super.call(this, metas);
            this.type = metas.type;
            this.callback = metas.callback;
        }
        /**
         * 获取类型。
         */
        Step.prototype.gType = function () {
            return 'step';
        };
        return Step;
    }(Ev.Event));
    Ev.Step = Step;
})(Ev || (Ev = {}));
/**
 * 数据库配置实体。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      Runtime/ConfigDBFlow.ts
 */
/// <reference path="../Flow.ts" />
/// <reference path="../../Core/_Runtime/IConfigDBFlow.ts" />
/// <reference path="../../Ev/Step.ts" />
var Runtime;
(function (Runtime) {
    var ConfigDBFlow = (function (_super) {
        __extends(ConfigDBFlow, _super);
        /**
         * 构造函数。
         */
        function ConfigDBFlow(config) {
            _super.call(this);
            this.databases = {
                'Oracle': { 'driver': 'oracle.jdbc.driver.OracleDriver', 'url': 'jdbc:oracle:thin:@127.0.0.1:1521:databasename' },
                'SQL Server': { 'driver': 'net.sourceforge.jtds.jdbc.Driver', 'url': 'jdbc:jtds:sqlserver://hostname/databasename;useCursors=true;bufferMaxMemory=10240;lobBuffer=5242880;socketTimeout=300;appName=syncdb' },
                'DB2': { 'driver': 'com.ibm.db2.jcc.DB2Driver', 'url': 'jdbc:db2://hostname:50000/databasename' },
                'Mysql': { 'driver': 'com.mysql.jdbc.Driver', 'url': 'jdbc:mysql://hostname/databasename?tinyInt1isBit=false&zeroDateTimeBehavior=convertToNull' }
            };
            /**
             * 弹出框配置
             */
            this.alertConf = {
                cancel: false,
                title: '提示',
                okValue: '确定',
                ok: function () {
                    //
                }
            };
            /**
             * 提示框配置
             */
            this.promptConf = {
                cancel: false
            };
            this.wizConfig = config;
        }
        /**
         * 步骤验证
         */
        ConfigDBFlow.prototype.validate = function () {
            var _this = this;
            this.testConn(function (isTestSuc) {
                if (isTestSuc) {
                    _this.view.props.parentFlow.dispatchEvent(new Ev.Step({
                        target: _this.view.props.parentFlow,
                        type: "db.next"
                    }));
                }
            });
            return false;
        };
        ConfigDBFlow.prototype.getDatabases = function () {
            return this.databases;
        };
        /**
         * 测试数据库连接
         */
        ConfigDBFlow.prototype.testConn = function (cb) {
            var alertDialog = dialog(this.alertConf);
            var dbType = this.wizConfig['db.type'];
            var dbDriver = this.wizConfig['db.driver'];
            var dbUrl = this.wizConfig['db.url'];
            var dbUser = this.wizConfig['db.user'];
            var dbPsw = this.wizConfig['db.psw'];
            if (!dbType || !dbDriver || !dbUrl || !dbUser || !dbPsw) {
                alertDialog.content("<span class='alert'><span class='icon icon-notification'></span><span class='title'>请完成数据库配置</span>");
                alertDialog.showModal();
                cb(false);
            }
            var prompt = dialog(this.promptConf);
            prompt.content("正在测试数据库连接，请稍候。");
            prompt.showModal();
            this.view.props.parentFlow.connTest().then(function (isSuc) {
                prompt.close();
                if (!isSuc) {
                    alertDialog.content("<span class='alert'><span class='icon icon-notification'></span><span class='title'>连接失败</span>");
                    alertDialog.showModal();
                }
                cb(isSuc);
            });
        };
        return ConfigDBFlow;
    }(Runtime.Flow));
    Runtime.ConfigDBFlow = ConfigDBFlow;
})(Runtime || (Runtime = {}));
/**
 * 声明节点注册业务流接口规范。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      Core/_Runtime/IRegisteInfoFlow.ts
 */
/// <reference path="IStepFlow.ts" />
/// <reference path="../_View/IView.ts" />
/**
 * 节点注册信息实体。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      Runtime/RegisteInfoFlow.ts
 */
/// <reference path="../Flow.ts" />
/// <reference path="../../Core/_Runtime/IRegisteInfoFlow.ts" />
/// <reference path="../StageFlow.tsx" />
var Runtime;
(function (Runtime) {
    var RegisteInfoFlow = (function (_super) {
        __extends(RegisteInfoFlow, _super);
        /**
         * 构造函数。
         */
        function RegisteInfoFlow(config) {
            _super.call(this);
            /**
             * 弹出框配置
             */
            this.alertConf = {
                cancel: false,
                title: '提示',
                okValue: '确定',
                ok: function () {
                    //
                }
            };
            this.wizConfig = config;
        }
        /**
         * 保存从库设置的同步接口URL
         */
        RegisteInfoFlow.prototype.save = function (url) {
            this.wizConfig['registration.url'] = url;
        };
        /**
         * 生成主端的同步接口URL
         */
        RegisteInfoFlow.prototype.genSyncURL = function () {
            var contextPath = document.querySelector("#p").getAttribute("ref");
            var local = window.location;
            return local.protocol + "://" + local.host + contextPath + "/sync/" + Runtime.StageFlow.ENGINE_NAME;
        };
        /**
         * 步骤验证
         */
        RegisteInfoFlow.prototype.validate = function () {
            if (this.wizConfig['type'] == 'master')
                return true;
            if (!this.wizConfig['registration.url'] || /(^\s+)|(\s+$)/ig.test(this.wizConfig['registration.url'])) {
                var alert_1 = dialog(this.alertConf);
                // <span class='alert'><span class='icon icon-notification'></span><span class='title'>连接失败</span>
                alert_1.content("<span class='alert'><span class='icon icon-notification'></span><span class='title'>主库节点URL填写不正确，请检查所填写的内容。</span>");
                alert_1.showModal();
                return false;
            }
            else {
                return true;
            }
        };
        return RegisteInfoFlow;
    }(Runtime.Flow));
    Runtime.RegisteInfoFlow = RegisteInfoFlow;
})(Runtime || (Runtime = {}));
/**
 * 声明保存登录用户业务流接口规范。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      Core/_Runtime/IConfigUserFlow.ts
 */
/// <reference path="IStepFlow.ts" />
/// <reference path="../_View/IView.ts" />
/**
 * 生成用户业务流。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      Runtime/ConfigUserFlow.ts
 */
/// <reference path="../Flow.ts" />
/// <reference path="../../Core/_Runtime/IConfigUserFlow.ts" />
var Runtime;
(function (Runtime) {
    var ConfigUserFlow = (function (_super) {
        __extends(ConfigUserFlow, _super);
        /**
         * 构造函数。
         */
        function ConfigUserFlow(config) {
            _super.call(this);
        }
        /**
         * 生成用户
         */
        ConfigUserFlow.prototype.genUser = function () {
            //
        };
        /**
         * 步骤验证
         */
        ConfigUserFlow.prototype.validate = function () {
            return true;
        };
        return ConfigUserFlow;
    }(Runtime.Flow));
    Runtime.ConfigUserFlow = ConfigUserFlow;
})(Runtime || (Runtime = {}));
/**
 * 声明配置完成完成业务流接口规范。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      Core/_Runtime/IFinishFlow.ts
 */
/// <reference path="IStepFlow.ts" />
/// <reference path="../_View/IView.ts" />
/**
 * 配置完成实体。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      Runtime/FinishFlow.ts
 */
/// <reference path="../Flow.ts" />
/// <reference path="../../Core/_Runtime/IFinishFlow.ts" />
var Runtime;
(function (Runtime) {
    var FinishFlow = (function (_super) {
        __extends(FinishFlow, _super);
        /**
         * 构造函数。
         */
        function FinishFlow(config) {
            _super.call(this);
            /**
             * 项目上下文
             */
            this.contextPath = document.querySelector("#p").getAttribute("ref");
            /**
             * 弹出框配置
             */
            this.alertConf = {
                cancel: false,
                title: '提示',
                okValue: '确定',
                ok: function () {
                    //
                }
            };
            /**
             * 提示框配置
             */
            this.promptConf = {
                cancel: false
            };
            this.wizConfig = config;
        }
        /**
         * 处理配置完成业务
         */
        FinishFlow.prototype.finish = function () {
            var _this = this;
            // let alert: any = dialog(this.alertConf);
            var prompt = dialog(this.promptConf);
            prompt.content("<span class='col loading'>请稍候，正在生成同步工具系统设置。</span><img class='col loading' src='" + this.contextPath + "/s/images/loading.gif'>");
            prompt.showModal();
            Util.Remote.post(this.contextPath + "/wizard/save", this.wizConfig, function (data) {
                var isWizSuc = data['code'] != "0";
                prompt.close();
                if (isWizSuc) {
                    var alertDialog_1;
                    _this.alertConf['ok'] = function () {
                        if (alertDialog_1)
                            alertDialog_1.close();
                        _this.view.props.parentFlow.dispatchEvent(new Ev.Step({
                            target: _this.view.props.parentFlow,
                            type: "finish"
                        }));
                    };
                    alertDialog_1 = dialog(_this.alertConf);
                    alertDialog_1.content("<span class='alert'><span class='icon icon-checkmark'></span><span class='title'>配置成功。</span>");
                    alertDialog_1.showModal();
                }
            }, null);
        };
        /**
         * 步骤验证
         */
        FinishFlow.prototype.validate = function () {
            return true;
        };
        return FinishFlow;
    }(Runtime.Flow));
    Runtime.FinishFlow = FinishFlow;
})(Runtime || (Runtime = {}));
/**
 * 向导业务流实体。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      Runtime/Stage.ts
 */
/// <reference path="Flow.ts" />
/// <reference path="../View/Stage.tsx" />
/// <reference path="../Core/_Runtime/IStageFlow.ts" />
/// <reference path="_Steps/NodeChoiceFlow.ts" />
/// <reference path="_Steps/ConfigDBFlow.ts" />
/// <reference path="_Steps/RegisteInfoFlow.ts" />
/// <reference path="_Steps/ConfigUserFlow.ts" />
/// <reference path="_Steps/FinishFlow.ts" />
/// <reference path="../Ev/Step.ts" />
var Runtime;
(function (Runtime) {
    var StageFlow = (function (_super) {
        __extends(StageFlow, _super);
        /**
         * 构造函数。
         */
        function StageFlow(container) {
            var _this = this;
            _super.call(this);
            /**
             * type 节点类型
             * db.driver
             * db.url
             * db.user
             * db.psw
             * registration.url
             * sync.url
             * user
             * psw
             */
            this.configDatas = {};
            /**
             * 子视图对应业务流实体哈希表
             */
            this.subViewFlowHash = {};
            /**
             * 当前所在步骤的索引号
             */
            this.stepIndex = 0;
            /**
             * 步骤顺序
             * "nodeChoice", "configDB", "registeInfo", "configUser", "finish"
             */
            this.stepOrder = ["nodeChoice", "configDB", "registeInfo", "finish"];
            /**
             * 项目上下文
             */
            this.contextPath = document.querySelector("#p").getAttribute("ref");
            this.view = React.render(React.createElement(View.Stage, {flow: this}), container);
            this.addEventListener("step", function (ev) {
                if (ev.type == "db.next") {
                    _this.configDBNext();
                }
                else if (ev.type == "finish") {
                    _this.finish();
                }
            });
        }
        /**
         * 取得配置数据。
         */
        StageFlow.prototype.gConfig = function () {
            return this.configDatas;
        };
        /**
         * 绑定子视图与Flow。
         */
        StageFlow.prototype.make = function (type) {
            if (this.subViewFlowHash && type in this.subViewFlowHash)
                return this.subViewFlowHash[type];
            var flow;
            switch (type) {
                case 'nodeChoice':
                    flow = new Runtime.NodeChoiceFlow(this.configDatas);
                    break;
                case 'configDB':
                    flow = new Runtime.ConfigDBFlow(this.configDatas);
                    break;
                case 'registeInfo':
                    flow = new Runtime.RegisteInfoFlow(this.configDatas);
                    break;
                case 'configUser':
                    flow = new Runtime.ConfigUserFlow(this.configDatas);
                    break;
                case 'finish':
                    flow = new Runtime.FinishFlow(this.configDatas);
                    break;
            }
            this.subViewFlowHash[type] = flow;
            return flow;
        };
        /**
         * 取得当前步骤索引号。
         * 索引号从0开始
         */
        StageFlow.prototype.gStepIndex = function () {
            return this.stepIndex;
        };
        /**
         * 设置当前步骤索引号。
         * 索引号从0开始
         */
        StageFlow.prototype.sStepIndex = function (index) {
            if (index < 0)
                this.stepIndex = 0;
        };
        /**
         * 上一步。
         */
        StageFlow.prototype.previous = function (ev) {
            if (this.stepIndex <= 0)
                return;
            this.stepIndex -= 1;
            this.view.forceUpdate();
        };
        /**
         * 下一步。
         */
        StageFlow.prototype.next = function (ev) {
            var stepFlow = this.make(this.stepOrder[this.stepIndex]);
            if (this.stepIndex == 1) {
                stepFlow.validate();
                return;
            }
            if (this.stepIndex < this.stepOrder.length - 1 && stepFlow.validate()) {
                this.stepIndex += 1;
            }
            this.view.forceUpdate();
        };
        /**
         * 完成。
         */
        StageFlow.prototype.finish = function () {
            window.location.href = Util.Path.gOrigin();
        };
        /**
         * 测试数据库连接
         */
        StageFlow.prototype.connTest = function () {
            var _this = this;
            var dbType = this.configDatas['db.type'];
            var dbDriver = this.configDatas['db.driver'];
            var dbUrl = this.configDatas['db.url'];
            var dbUser = this.configDatas['db.user'];
            var dbPsw = this.configDatas['db.psw'];
            if (!dbType || !dbDriver || !dbUrl || !dbUser || !dbPsw) {
                return new Promise(function (resolve) {
                    resolve(false);
                });
            }
            var testData = {
                type: dbType || '',
                driver: dbDriver || '',
                url: dbUrl || '',
                u: dbUser || '',
                p: dbPsw || ''
            };
            return new Promise(function (resolve) {
                Util.Remote.post(_this.contextPath + "/wizard/testConn", testData, function (data) {
                    resolve(data["code"] == "1");
                }, null);
            });
        };
        /**
         * 数据库配置的下一步由数据库配置业务自己调用
         */
        StageFlow.prototype.configDBNext = function () {
            this.stepIndex += 1;
            this.view.forceUpdate();
        };
        /**
         * 引擎名
         */
        StageFlow.ENGINE_NAME = "dbtool";
        return StageFlow;
    }(Runtime.Flow));
    Runtime.StageFlow = StageFlow;
})(Runtime || (Runtime = {}));
/**
 * 向导运行时实体。
 *
 * @author    姚尧 <yaogaoyu@qq.com>
 * @file      Runtime/Runtime.ts
 */
/// <reference path="StageFlow.tsx" />
var Runtime;
(function (Runtime_1) {
    var Runtime = (function () {
        /**
         * 构造函数。
         */
        function Runtime() {
            var container = document.querySelector('.wizard');
            this.stage = new Runtime_1.StageFlow(container);
        }
        return Runtime;
    }());
    Runtime_1.Runtime = Runtime;
})(Runtime || (Runtime = {}));
/**
 * 同步工具配置向导入口类。
 *
 * @author    姚尧 <yaogaoyu@163.com>
 * @file      Wizard.ts
 */
/// <reference path="Runtime/Runtime.ts" />
var Wizard = (function () {
    /**
     * 构造函数。
     */
    function Wizard() {
        this.runtime = new Runtime.Runtime();
    }
    Wizard.version = "0.1.0";
    return Wizard;
}());
module.exports=Wizard;


},{}]},{},[])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJ2YXIvYnVpbGQvd2l6YXJkIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikge1xuICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdO1xuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbn07XG4vKipcbiAqIOWjsOaYjuWTiOW4jOihqOaOpeWPo+inhOiMg+OAglxuICpcbiAqIEBhdXRob3IgICAg5aea5bCnIDx5YW9nYW95dUAxNjMuY29tPlxuICogQGxpY2Vuc2UgICBHUEwtMy4wXG4gKiBAZmlsZSAgICAgIFV0aWwvSUhhc2hUYWJsZS50c1xuICovXG4vKipcbiAqIOWjsOaYjuinhuWbvueKtuaAgeaOpeWPo+inhOiMg+OAglxuICpcbiAqIEBhdXRob3IgICAg5aea5bCnIDx5YW9nYW95dUBxcS5jb20+XG4gKiBAZmlsZSAgICAgIENvcmUvX1ZpZXcvSVN0YXRlLnRzXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi9VdGlsL0lIYXNoVGFibGUudHNcIiAvPlxuLyoqXG4gKiDlo7DmmI7op4blm77lsZ7mgKfmjqXlj6Pop4TojIPjgIJcbiAqXG4gKiBAYXV0aG9yICAgIOWnmuWwpyA8eWFvZ2FveXVAcXEuY29tPlxuICogQGZpbGUgICAgICBDb3JlL19WaWV3L0lQcm9wcy50c1xuICovXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vVXRpbC9JSGFzaFRhYmxlLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9fUnVudGltZS9JRmxvdy50c1wiIC8+XG4vKipcbiAqIOWjsOaYjuinhuWbvuinhOiMg+OAglxuICpcbiAqIEBhdXRob3IgICAg5aea5bCnIDx5YW9nYW95dUBxcS5jb20+XG4gKiBAZmlsZSAgICAgIENvcmUvX1ZpZXcvSVZpZXcudHNcbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL1V0aWwvSUhhc2hUYWJsZS50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vLi4vaW5jbHVkZS9yZWFjdC9yZWFjdC1nbG9iYWwuZC50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiSVN0YXRlLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJJUHJvcHMudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL19SdW50aW1lL0lGbG93LnRzXCIgLz5cbi8qKlxuICog5aOw5piO77yI6L+Q6KGM5pe277yJ5LqL5Lu25YWD5L+h5oGv5o6l5Y+j6KeE6IyD44CCXG4gKlxuICogQGF1dGhvciAgICDpg5HnhZzlrocgPHl6aGVuZ0BhdGZhY2cuY29tPlxuICogQGNvcHlyaWdodCDCqSAyMDE1IERhaGFvLmRlXG4gKiBAbGljZW5zZSAgIEdQTC0zLjBcbiAqIEBmaWxlICAgICAgQ29yZS9fRXYvSUV2ZW50TWV0YXMudHNcbiAqL1xuLyoqXG4gKiDlo7DmmI7vvIjov5DooYzml7bvvInkuovku7bmjqXlj6Pop4TojIPjgIJcbiAqXG4gKiBAYXV0aG9yICAgIOmDkeeFnOWuhyA8eXpoZW5nQGF0ZmFjZy5jb20+XG4gKiBAY29weXJpZ2h0IMKpIDIwMTUgRGFoYW8uZGVcbiAqIEBsaWNlbnNlICAgR1BMLTMuMFxuICogQGZpbGUgICAgICBDb3JlL19Fdi9JRXZlbnQudHNcbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIklFdmVudE1ldGFzLnRzXCIgLz5cbi8qKlxuICog5aOw5piO77yI6L+Q6KGM5pe277yJ5LqL5Lu255uR5ZCs5Ye95pWw5o6l5Y+j6KeE6IyD44CCXG4gKlxuICogQGF1dGhvciAgICDpg5HnhZzlrocgPHl6aGVuZ0BhdGZhY2cuY29tPlxuICogQGNvcHlyaWdodCDCqSAyMDE1IERhaGFvLmRlXG4gKiBAbGljZW5zZSAgIEdQTC0zLjBcbiAqIEBmaWxlICAgICAgQ29yZS9fRXYvSUV2ZW50TGlzdGVuZXIudHNcbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIklFdmVudC50c1wiIC8+XG4vKipcbiAqIOWjsOaYju+8iOi/kOihjOaXtu+8ieS6i+S7tuWuv+S4u+aOpeWPo+inhOiMg+OAglxuICpcbiAqIEBhdXRob3IgICAg6YOR54Wc5a6HIDx5emhlbmdAYXRmYWNnLmNvbT5cbiAqIEBjb3B5cmlnaHQgwqkgMjAxNSBEYWhhby5kZVxuICogQGxpY2Vuc2UgICBHUEwtMy4wXG4gKiBAZmlsZSAgICAgIENvcmUvX0V2L0lFbWl0dGFibGUudHNcbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIklFdmVudExpc3RlbmVyLnRzXCIgLz5cbi8qKlxuICog5aOw5piO77yI6L+Q6KGM5pe277yJ5Lia5Yqh6YC76L6R5rWB5o6l5Y+j6KeE6IyD44CCXG4gKlxuICogQGF1dGhvciAgICDlp5rlsKcgPHlhb2dhb3l1QHFxLmNvbT5cbiAqIEBmaWxlICAgICAgQ29yZS9fUnVudGltZS9JRmxvdy50c1xuICovXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vX1ZpZXcvSVZpZXcudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL19Fdi9JRW1pdHRhYmxlLnRzXCIgLz5cbi8qKlxuICog5aOw5piO5pWw57uE6YGN5Y6G5Ye95pWw5o6l5Y+j6KeE6IyD44CCXG4gKlxuICogQGF1dGhvciAgICDlp5rlsKcgPHlhb2dhb3l1QDE2My5jb20+XG4gKiBAbGljZW5zZSAgIEdQTC0zLjBcbiAqIEBmaWxlICAgICAgVXRpbC9JQXJyYXlJdGVyYXRvci50c1xuICovXG4vKipcbiAqIOWjsOaYjuWvueixoemBjeWOhuWHveaVsOaOpeWPo+inhOiMg+OAglxuICpcbiAqIEBhdXRob3IgICAg5aea5bCnIDx5YW9nYW95dUAxNjMuY29tPlxuICogQGxpY2Vuc2UgICBHUEwtMy4wXG4gKiBAZmlsZSAgICAgIFV0aWwvSU9iamVjdEl0ZXJhdG9yLnRzXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJJSGFzaFRhYmxlLnRzXCIgLz5cbi8qKlxuICog5a6a5LmJ5pWw57uE57G75bel5YW35pa55rOV44CCXG4gKlxuICogQGF1dGhvciAgICDlp5rlsKcgPHlhb2dhb3l1QDE2My5jb20+XG4gKiBAbGljZW5zZSAgIEdQTC0zLjBcbiAqIEBmaWxlICAgICAgVXRpbC9faXRlcmF0b3IudHNcbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIklBcnJheUl0ZXJhdG9yLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJJT2JqZWN0SXRlcmF0b3IudHNcIiAvPlxudmFyIFV0aWw7XG4oZnVuY3Rpb24gKFV0aWwpIHtcbiAgICBmdW5jdGlvbiBlYWNoKG9iaiwgY2IsICR0aGlzKSB7XG4gICAgICAgICR0aGlzID0gJHRoaXMgfHwge307XG4gICAgICAgIHZhciBpaTtcbiAgICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICBpZiAob2JqLmZvckVhY2gpXG4gICAgICAgICAgICAgICAgcmV0dXJuIG9iai5mb3JFYWNoKGNiLCAkdGhpcyk7XG4gICAgICAgICAgICBmb3IgKGlpID0gMDsgaWkgPCBvYmoubGVuZ3RoOyBpaSsrKVxuICAgICAgICAgICAgICAgIGNiLmNhbGwoJHRoaXMsIG9ialtpaV0sIGlpLCBvYmopO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoaWkgaW4gb2JqKVxuICAgICAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShpaSkpXG4gICAgICAgICAgICAgICAgY2IuY2FsbCgkdGhpcywgb2JqW2lpXSwgaWksIG9iaik7XG4gICAgfVxuICAgIFV0aWwuZWFjaCA9IGVhY2g7XG4gICAgZnVuY3Rpb24gZXZlcnkob2JqLCBjYiwgJHRoaXMpIHtcbiAgICAgICAgJHRoaXMgPSAkdGhpcyB8fCB7fTtcbiAgICAgICAgdmFyIGlpO1xuICAgICAgICBpZiAob2JqIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICAgIGlmIChvYmouZXZlcnkpXG4gICAgICAgICAgICAgICAgcmV0dXJuIG9iai5ldmVyeShjYiwgJHRoaXMpO1xuICAgICAgICAgICAgZm9yIChpaSA9IDA7IGlpIDwgb2JqLmxlbmd0aDsgaWkrKylcbiAgICAgICAgICAgICAgICBpZiAoIWNiLmNhbGwoJHRoaXMsIG9ialtpaV0sIGlpLCBvYmopKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgZm9yIChpaSBpbiBvYmopXG4gICAgICAgICAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShpaSkgJiYgIWNiLmNhbGwoJHRoaXMsIG9ialtpaV0sIGlpLCBvYmopKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBVdGlsLmV2ZXJ5ID0gZXZlcnk7XG4gICAgZnVuY3Rpb24gc29tZShvYmosIGNiLCAkdGhpcykge1xuICAgICAgICAkdGhpcyA9ICR0aGlzIHx8IHt9O1xuICAgICAgICB2YXIgaWk7XG4gICAgICAgIGlmIChvYmogaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgaWYgKG9iai5zb21lKVxuICAgICAgICAgICAgICAgIHJldHVybiBvYmouc29tZShjYiwgJHRoaXMpO1xuICAgICAgICAgICAgZm9yIChpaSA9IDA7IGlpIDwgb2JqLmxlbmd0aDsgaWkrKylcbiAgICAgICAgICAgICAgICBpZiAoY2IuY2FsbCgkdGhpcywgb2JqW2lpXSwgaWksIG9iaikpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGZvciAoaWkgaW4gb2JqKVxuICAgICAgICAgICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoaWkpICYmIGNiLmNhbGwoJHRoaXMsIG9ialtpaV0sIGlpLCBvYmopKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBVdGlsLnNvbWUgPSBzb21lO1xuICAgIGZ1bmN0aW9uIGluZGV4T2Yob2JqLCBpdGVtLCBvZmZzZXQpIHtcbiAgICAgICAgaWYgKG9mZnNldCA9PT0gdm9pZCAwKSB7IG9mZnNldCA9IDA7IH1cbiAgICAgICAgdmFyIGlpO1xuICAgICAgICBpZiAob2JqIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICAgIGlmIChvYmouaW5kZXhPZilcbiAgICAgICAgICAgICAgICByZXR1cm4gb2JqLmluZGV4T2YoaXRlbSwgb2Zmc2V0KTtcbiAgICAgICAgICAgIGZvciAoaWkgPSBvZmZzZXQ7IGlpIDwgb2JqLmxlbmd0aDsgaWkrKylcbiAgICAgICAgICAgICAgICBpZiAob2JqW2lpXSA9PSBpdGVtKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaWk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgZm9yIChpaSBpbiBvYmopXG4gICAgICAgICAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShpaSkgJiYgb2JqW2lpXSA9PSBpdGVtKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaWk7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgVXRpbC5pbmRleE9mID0gaW5kZXhPZjtcbiAgICBmdW5jdGlvbiBjbG9uZShvcmlnKSB7XG4gICAgICAgIGlmICgnb2JqZWN0JyAhPSB0eXBlb2Ygb3JpZylcbiAgICAgICAgICAgIHJldHVybiBvcmlnO1xuICAgICAgICBpZiAob3JpZyBpbnN0YW5jZW9mIEFycmF5KVxuICAgICAgICAgICAgcmV0dXJuIG9yaWcuc2xpY2UoMCk7XG4gICAgICAgIHZhciBkb2xseSA9IHt9O1xuICAgICAgICBVdGlsLmVhY2gob3JpZywgZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgICAgIGRvbGx5W2tleV0gPSB2YWx1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBkb2xseTtcbiAgICB9XG4gICAgVXRpbC5jbG9uZSA9IGNsb25lO1xufSkoVXRpbCB8fCAoVXRpbCA9IHt9KSk7XG4vKipcbiAqIOWumuS5ie+8iOi/kOihjOaXtu+8ieS4muWKoemAu+i+kea1gee7hOS7tuOAglxuICpcbiAqIEBhdXRob3IgICAg5aea5bCnIDx5YW9nYW95dUBxcS5jb20+XG4gKiBAZmlsZSAgICAgIFJ1bnRpbWUvRmxvdy50c1xuICovXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vQ29yZS9fUnVudGltZS9JRmxvdy50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vVXRpbC9faXRlcmF0b3IudHNcIiAvPlxudmFyIFJ1bnRpbWU7XG4oZnVuY3Rpb24gKFJ1bnRpbWUpIHtcbiAgICB2YXIgRmxvdyA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiDmnoTpgKDlh73mlbDjgIJcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIEZsb3coKSB7XG4gICAgICAgICAgICB0aGlzLmxpc3RlbmVycyA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiDojrflj5bnu5Hlrprop4blm77jgIJcbiAgICAgICAgICovXG4gICAgICAgIEZsb3cucHJvdG90eXBlLmdWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudmlldztcbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOiuvue9rue7keWumuinhuWbvuOAglxuICAgICAgICAgKi9cbiAgICAgICAgRmxvdy5wcm90b3R5cGUuc1ZpZXcgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICAgICAgdGhpcy52aWV3ID0gdmlldztcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9O1xuICAgICAgICAvKipcbiAgICAgICAgICog5paw5aKe5LqL5Lu255uR5ZCs44CCXG4gICAgICAgICAqL1xuICAgICAgICBGbG93LnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgICAgICAgICB0aGlzLmxpc3RlbmVyc1t0eXBlXSA9IHRoaXMubGlzdGVuZXJzW3R5cGVdIHx8IFtdO1xuICAgICAgICAgICAgdmFyIHBvcyA9IFV0aWwuaW5kZXhPZih0aGlzLmxpc3RlbmVyc1t0eXBlXSwgbGlzdGVuZXIpO1xuICAgICAgICAgICAgaWYgKC0xID09IHBvcylcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlbmVyc1t0eXBlXS5wdXNoKGxpc3RlbmVyKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9O1xuICAgICAgICAvKipcbiAgICAgICAgICog5Y+W5raI5LqL5Lu255uR5ZCs44CCXG4gICAgICAgICAqL1xuICAgICAgICBGbG93LnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgICAgICAgICB0aGlzLmxpc3RlbmVyc1t0eXBlXSA9IHRoaXMubGlzdGVuZXJzW3R5cGVdIHx8IFtdO1xuICAgICAgICAgICAgdmFyIHBvcyA9IFV0aWwuaW5kZXhPZih0aGlzLmxpc3RlbmVyc1t0eXBlXSwgbGlzdGVuZXIpO1xuICAgICAgICAgICAgaWYgKC0xICE9IHBvcylcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlbmVyc1t0eXBlXS5zcGxpY2UocG9zLCAxKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9O1xuICAgICAgICAvKipcbiAgICAgICAgICog5Y+R55Sf5LqL5Lu244CCXG4gICAgICAgICAqL1xuICAgICAgICBGbG93LnByb3RvdHlwZS5kaXNwYXRjaEV2ZW50ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICBVdGlsLmVhY2godGhpcy5saXN0ZW5lcnNbZXZlbnQuZ1R5cGUoKV0gfHwgW10sIGZ1bmN0aW9uIChsaXN0ZW5lcikge1xuICAgICAgICAgICAgICAgIGxpc3RlbmVyKGV2ZW50KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBGbG93O1xuICAgIH0oKSk7XG4gICAgUnVudGltZS5GbG93ID0gRmxvdztcbn0pKFJ1bnRpbWUgfHwgKFJ1bnRpbWUgPSB7fSkpO1xuLyoqXG4gKiDlrprkuYnop4blm77mir3osaHnu4Tku7bjgIJcbiAqXG4gKiBAYXV0aG9yICAgIOWnmuWwpyA8eWFvZ2FveXVAcXEuY29tPlxuICogQGZpbGUgICAgICBWaWV3L1ZpZXcudHNcbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL2luY2x1ZGUvdHNkLmQudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL0NvcmUvX1ZpZXcvSVZpZXcudHNcIiAvPlxudmFyIFZpZXc7XG4oZnVuY3Rpb24gKFZpZXdfMSkge1xuICAgIHZhciBWaWV3ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFZpZXcsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFZpZXcoKSB7XG4gICAgICAgICAgICBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gVmlldztcbiAgICB9KFJlYWN0LkNvbXBvbmVudCkpO1xuICAgIFZpZXdfMS5WaWV3ID0gVmlldztcbn0pKFZpZXcgfHwgKFZpZXcgPSB7fSkpO1xuLyoqXG4gKiDlrprkuYlQYXRo5L+h5oGv57uE5Lu244CCXG4gKlxuICogQGF1dGhvciAgICDlp5rlsKcgPHlhb2dhb3l1QDE2My5jb20+XG4gKiBAbGljZW5zZSAgIEdQTC0zLjBcbiAqIEBmaWxlICAgICAgVXRpbC9QYXRoLnRzXG4gKi9cbnZhciBVdGlsO1xuKGZ1bmN0aW9uIChVdGlsKSB7XG4gICAgdmFyIFBhdGg7XG4gICAgKGZ1bmN0aW9uIChQYXRoKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiDojrflj5bmjIflrprpg6jnvbLmoLnnm67lvZXjgIJcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGdPcmlnaW4oKSB7XG4gICAgICAgICAgICB2YXIgb3JpZ2luID0gd2luZG93LmxvY2F0aW9uLm9yaWdpbjtcbiAgICAgICAgICAgIHZhciBwYXRobmFtZSA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZTtcbiAgICAgICAgICAgIHZhciByb290ID0gcGF0aG5hbWUubWF0Y2goLy4qXFwvLylbMF07XG4gICAgICAgICAgICByZXR1cm4gb3JpZ2luICsgcm9vdDtcbiAgICAgICAgfVxuICAgICAgICBQYXRoLmdPcmlnaW4gPSBnT3JpZ2luO1xuICAgIH0pKFBhdGggPSBVdGlsLlBhdGggfHwgKFV0aWwuUGF0aCA9IHt9KSk7XG59KShVdGlsIHx8IChVdGlsID0ge30pKTtcbi8qKlxuICog6YWN572u5ZCR5a+8LeiKgueCueexu+Wei+mAieaLqeS4u+inhuWbvuOAglxuICpcbiAqIEBhdXRob3IgICAg5aea5bCnIDx5YW9nYW95dUBxcS5jb20+XG4gKiBAZmlsZSAgICAgIFZpZXcvTm9kZUNob2ljZS50c1xuICovXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vVmlldy50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vVXRpbC9QYXRoLnRzXCIgLz5cbnZhciBWaWV3O1xuKGZ1bmN0aW9uIChWaWV3KSB7XG4gICAgdmFyIE5vZGVDaG9pY2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoTm9kZUNob2ljZSwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gTm9kZUNob2ljZShwcm9wcykge1xuICAgICAgICAgICAgX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpO1xuICAgICAgICAgICAgdGhpcy5vcmlnaW4gPSBVdGlsLlBhdGguZ09yaWdpbigpO1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5mbG93LnNWaWV3KHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIE5vZGVDaG9pY2UucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7Y2xhc3NOYW1lOiAnd3JhcCd9LCBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtjbGFzc05hbWU6ICd0aXRsZSd9LCBcIuatpemqpOS4gO+8muiKgueCueexu+Wei+mAieaLqVwiKSwgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7Y2xhc3NOYW1lOiAnZGVzYyd9LCBcIumAieaLqeS4gOS4qui/m+ihjOWQjOatpeacjeWKoeeahOiKgueCueexu+Wei1wiKSwgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7Y2xhc3NOYW1lOiAnZm9ybVdyYXAnfSwgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7Y2xhc3NOYW1lOiAnbm9kZVR5cGUnfSwgUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwge2NsYXNzTmFtZTogJ2lubGluZSB0eXBlJ30sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIHtjbGFzc05hbWU6ICdpYnRuIHR5cGVCdG4nICsgKHRoaXMucHJvcHMuY29uZmlnWyd0eXBlJ10gPT0gJ21hc3RlcicgPyAnIHNlbGVjdGVkJyA6ICcnKSwgb25DbGljazogZnVuY3Rpb24gKGV2dCkgeyBfdGhpcy5jaG9pY2UoZXZ0LCAnbWFzdGVyJyk7IH19LCBSZWFjdC5jcmVhdGVFbGVtZW50KFwiaW1nXCIsIHtzcmM6IHRoaXMub3JpZ2luICsgJ3MvaW1hZ2VzL25vZGUucG5nJ30pKSksIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIHtjbGFzc05hbWU6ICdpbmxpbmUgdHlwZSB0eXBlTmFtZSd9LCBcIk1hc3RlclwiKSwgUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwge2NsYXNzTmFtZTogJ2lubGluZSB0eXBlIGRlc2MnfSwgXCLkuLvlupPoioLngrnvvIzmr4/kuKrms6jlhozliLDmraTkuLvoioLngrnkuIrnmoTku47lupPoioLngrnlsIbkvb/nlKjkuLvlupPoioLngrnmj5DkvpvnmoTmnI3liqHov5vooYzmlbDmja7lkIzmraXjgIJcIikpLCBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtjbGFzc05hbWU6ICdub2RlVHlwZSd9LCBSZWFjdC5jcmVhdGVFbGVtZW50KFwic3BhblwiLCB7Y2xhc3NOYW1lOiAnaW5saW5lIHR5cGUnfSwgUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwge2NsYXNzTmFtZTogJ2lidG4gdHlwZUJ0bicgKyAodGhpcy5wcm9wcy5jb25maWdbJ3R5cGUnXSA9PSAnc2xhdmVyJyA/ICcgc2VsZWN0ZWQnIDogJycpLCBvbkNsaWNrOiBmdW5jdGlvbiAoZXZ0KSB7IF90aGlzLmNob2ljZShldnQsICdzbGF2ZXInKTsgfX0sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJpbWdcIiwge3NyYzogdGhpcy5vcmlnaW4gKyAncy9pbWFnZXMvbm9kZS5wbmcnfSkpKSwgUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwge2NsYXNzTmFtZTogJ2lubGluZSB0eXBlIHR5cGVOYW1lJ30sIFwiU2xhdmVyXCIpLCBSZWFjdC5jcmVhdGVFbGVtZW50KFwic3BhblwiLCB7Y2xhc3NOYW1lOiAnaW5saW5lIHR5cGUgZGVzYyd9LCBcIuS7juW6k+iKgueCue+8jOi/nuaOpeS4u+W6k+iKgueCue+8jOS4juaJgOacieazqOWGjOWcqOS4u+W6k+iKgueCueS4iueahOS7juW6k+iKgueCuei/m+ihjOaVsOaNruWQjOatpeOAglwiKSkpKTtcbiAgICAgICAgfTtcbiAgICAgICAgTm9kZUNob2ljZS5wcm90b3R5cGUuY2hvaWNlID0gZnVuY3Rpb24gKGV2LCB0eXBlKSB7XG4gICAgICAgICAgICBpZiAoIXR5cGUpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5mbG93LmNob2ljZVR5cGUodHlwZSk7XG4gICAgICAgICAgICB0aGlzLmZvcmNlVXBkYXRlKCk7XG4gICAgICAgICAgICAvLyDlj5HpgIHkuovku7bliLBzdGFnZei/m+ihjOS4i+S4gOS4quatpemqpFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gTm9kZUNob2ljZTtcbiAgICB9KFZpZXcuVmlldykpO1xuICAgIFZpZXcuTm9kZUNob2ljZSA9IE5vZGVDaG9pY2U7XG59KShWaWV3IHx8IChWaWV3ID0ge30pKTtcbi8qKlxuICog6YWN572u5ZCR5a+8LeaVsOaNruW6k+mFjee9ruS4u+inhuWbvuOAglxuICpcbiAqIEBhdXRob3IgICAg5aea5bCnIDx5YW9nYW95dUBxcS5jb20+XG4gKiBAZmlsZSAgICAgIFZpZXcvQ29uZmlnREIudHNcbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL1ZpZXcudHNcIiAvPlxudmFyIFZpZXc7XG4oZnVuY3Rpb24gKFZpZXcpIHtcbiAgICB2YXIgQ29uZmlnREIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoQ29uZmlnREIsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIENvbmZpZ0RCKHByb3BzKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpO1xuICAgICAgICAgICAgdGhpcy5kYk9wdGlvbnMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMucHJvcHMuZmxvdy5zVmlldyh0aGlzKTtcbiAgICAgICAgICAgIFV0aWwuZWFjaCh0aGlzLnByb3BzLmZsb3cuZ2V0RGF0YWJhc2VzKCksIGZ1bmN0aW9uIChpbmZvLCBkYk5hbWUpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5kYk9wdGlvbnMucHVzaChSZWFjdC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIsIHt2YWx1ZTogZGJOYW1lfSwgZGJOYW1lKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBDb25maWdEQi5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtjbGFzc05hbWU6ICd3cmFwJ30sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge2NsYXNzTmFtZTogJ3RpdGxlJ30sIFwi5q2l6aqk5LqM77ya5pWw5o2u5bqT6L+e5o6l6YWN572uXCIpLCBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtjbGFzc05hbWU6ICdkZXNjJ30sIFwi5pWw5o2u5bqT6YWN572u5a6M5oiQ5ZCO6K+35YWI5rWL6K+V6L+e5o6l77yM5rWL6K+V5oiQ5Yqf5omN6IO96L+b6KGM5LiL5LiA5q2l44CCXCIpLCBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtjbGFzc05hbWU6ICdmb3JtV3JhcCd9LCBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtjbGFzc05hbWU6ICdyb3cnfSwgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7Y2xhc3NOYW1lOiAndGl0bGUnfSwgXCLmlbDmja7lupNcIiksIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge2NsYXNzTmFtZTogJ2lucHV0J30sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJzZWxlY3RcIiwge2NsYXNzTmFtZTogJ3NlbCBkYlR5cGUnLCBvbkNoYW5nZTogZnVuY3Rpb24gKGV2KSB7IF90aGlzLmRiVHlwZUNoYW5nZShldik7IH0sIHZhbHVlOiB0aGlzLnByb3BzLmNvbmZpZ1tcImRiLnR5cGVcIl19LCBSZWFjdC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIsIHt2YWx1ZTogXCItMVwifSwgXCLor7fpgInmi6nmlbDmja7lupNcIiksIHRoaXMuZGJPcHRpb25zKSkpLCBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtjbGFzc05hbWU6ICdyb3cnfSwgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7Y2xhc3NOYW1lOiAndGl0bGUnfSwgXCLmlbDmja7lupPov57mjqVcIiksIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge2NsYXNzTmFtZTogJ2lucHV0J30sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiLCB7dHlwZTogJ3RleHQnLCBjbGFzc05hbWU6ICd0ZXh0IGRiSW5wdXQnLCB2YWx1ZTogdGhpcy5wcm9wcy5jb25maWdbXCJkYi51cmxcIl0sIG9uQ2hhbmdlOiBmdW5jdGlvbiAoZXYpIHsgX3RoaXMucHJvcHMuY29uZmlnW1wiZGIudXJsXCJdID0gZXZlbnQudGFyZ2V0LnZhbHVlOyBfdGhpcy5mb3JjZVVwZGF0ZSgpOyB9fSkpKSwgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7Y2xhc3NOYW1lOiAncm93J30sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge2NsYXNzTmFtZTogJ3RpdGxlJ30sIFwi55So5oi35ZCNXCIpLCBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtjbGFzc05hbWU6ICdpbnB1dCd9LCBSZWFjdC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIiwge3R5cGU6ICd0ZXh0JywgY2xhc3NOYW1lOiAndGV4dCBkYlVzZXInLCB2YWx1ZTogdGhpcy5wcm9wcy5jb25maWdbXCJkYi51c2VyXCJdLCBvbkNoYW5nZTogZnVuY3Rpb24gKGV2KSB7IF90aGlzLnByb3BzLmNvbmZpZ1tcImRiLnVzZXJcIl0gPSBldmVudC50YXJnZXQudmFsdWU7IF90aGlzLmZvcmNlVXBkYXRlKCk7IH19KSkpLCBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtjbGFzc05hbWU6ICdyb3cnfSwgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7Y2xhc3NOYW1lOiAndGl0bGUnfSwgXCLlr4bnoIFcIiksIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge2NsYXNzTmFtZTogJ2lucHV0J30sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiLCB7dHlwZTogJ3Bhc3N3b3JkJywgY2xhc3NOYW1lOiAndGV4dCBkYlBzdycsIHZhbHVlOiB0aGlzLnByb3BzLmNvbmZpZ1tcImRiLnBzd1wiXSwgb25DaGFuZ2U6IGZ1bmN0aW9uIChldikgeyBfdGhpcy5wcm9wcy5jb25maWdbXCJkYi5wc3dcIl0gPSBldmVudC50YXJnZXQudmFsdWU7IF90aGlzLmZvcmNlVXBkYXRlKCk7IH19KSkpKSk7XG4gICAgICAgIH07XG4gICAgICAgIENvbmZpZ0RCLnByb3RvdHlwZS5kYlR5cGVDaGFuZ2UgPSBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgICAgIHZhciBkYlR5cGUgPSBldmVudC50YXJnZXQudmFsdWU7XG4gICAgICAgICAgICBpZiAoZGJUeXBlID09IFwiLTFcIikge1xuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuY29uZmlnW1wiZGIudHlwZVwiXSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5jb25maWdbXCJkYi5kcml2ZXJcIl0gPSBcIlwiO1xuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuY29uZmlnW1wiZGIudXJsXCJdID0gXCJcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuY29uZmlnW1wiZGIudHlwZVwiXSA9IGRiVHlwZTtcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzLmNvbmZpZ1tcImRiLmRyaXZlclwiXSA9IHRoaXMucHJvcHMuZmxvdy5nZXREYXRhYmFzZXMoKVtkYlR5cGVdW1wiZHJpdmVyXCJdO1xuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuY29uZmlnW1wiZGIudXJsXCJdID0gdGhpcy5wcm9wcy5mbG93LmdldERhdGFiYXNlcygpW2RiVHlwZV1bXCJ1cmxcIl07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnByb3BzLmNvbmZpZ1tcImRiLnVzZXJcIl0gPSBcIlwiO1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5jb25maWdbXCJkYi5wc3dcIl0gPSBcIlwiO1xuICAgICAgICAgICAgdGhpcy5mb3JjZVVwZGF0ZSgpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gQ29uZmlnREI7XG4gICAgfShWaWV3LlZpZXcpKTtcbiAgICBWaWV3LkNvbmZpZ0RCID0gQ29uZmlnREI7XG59KShWaWV3IHx8IChWaWV3ID0ge30pKTtcbi8qKlxuICog6YWN572u5ZCR5a+8LeiKgueCueazqOWGjOS4u+inhuWbvuOAglxuICpcbiAqIEBhdXRob3IgICAg5aea5bCnIDx5YW9nYW95dUBxcS5jb20+XG4gKiBAZmlsZSAgICAgIFZpZXcvUmVnaXN0ZUluZm8udHNcbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL1ZpZXcudHNcIiAvPlxudmFyIFZpZXc7XG4oZnVuY3Rpb24gKFZpZXcpIHtcbiAgICB2YXIgUmVnaXN0ZUluZm8gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoUmVnaXN0ZUluZm8sIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFJlZ2lzdGVJbmZvKHByb3BzKSB7XG4gICAgICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcyk7XG4gICAgICAgICAgICB0aGlzLnByb3BzLmZsb3cuc1ZpZXcodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgUmVnaXN0ZUluZm8ucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7Y2xhc3NOYW1lOiAnd3JhcCd9LCBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtjbGFzc05hbWU6ICd0aXRsZSd9LCBcIuatpemqpOS4ie+8muiKgueCueazqOWGjOS/oeaBr1wiKSwgdGhpcy5wcm9wcy5jb25maWdbJ3R5cGUnXSA9PSAnbWFzdGVyJyA/XG4gICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7Y2xhc3NOYW1lOiAnZGVzYyBub2RlRGVzYyd9LCBcIuacrOiKgueCueiuvue9ruS4uuS4u+W6k+iKgueCue+8jOi/nuaOpeWIsOacrOiKgueCueeahOS7juW6k+iKgueCueWwhuS9v+eUqOatpFVSTOi/m+ihjOiKgueCueazqOWGjFwiKSA6XG4gICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7Y2xhc3NOYW1lOiAnZGVzYyBub2RlRGVzYyd9LCBcIuacrOiKgueCueiuvue9ruS4uuS7juW6k+iKgueCue+8jOivt+Whq+WGmeS4u+W6k+iKgueCueeahOazqOWGjOaOpeWPo1VSTFwiKSwgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7Y2xhc3NOYW1lOiAnZm9ybVdyYXAnfSwgdGhpcy5wcm9wcy5jb25maWdbJ3R5cGUnXSA9PSAnbWFzdGVyJyA/XG4gICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7Y2xhc3NOYW1lOiAncm93J30sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge2NsYXNzTmFtZTogJ3RpdGxlJ30sIFwi5LiL6Z2i55qE6ZO+5o6l5piv5rOo5YaM5o6l5Y+jVVJM77yM6K+36K6+572u5Yiw6L+b6KGM5pWw5o2u5ZCM5q2l55qE5LuO5bqT6IqC54K55Lit44CCXCIpLCBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtjbGFzc05hbWU6ICd0aXRsZSBpbXBvcnRhbnQnfSwgdGhpcy5wcm9wcy5mbG93LmdlblN5bmNVUkwoKSkpIDpcbiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtjbGFzc05hbWU6ICdyb3cnfSwgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7Y2xhc3NOYW1lOiAndGl0bGUnfSwgXCLor7floavlhpnkuLvlupPoioLngrnlj5HluIPnmoTms6jlhozmjqXlj6NVUkxcIiksIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge2NsYXNzTmFtZTogJ2lucHV0J30sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiLCB7dHlwZTogJ3RleHQnLCBjbGFzc05hbWU6ICd0ZXh0IHVybCcsIHZhbHVlOiB0aGlzLnByb3BzLmNvbmZpZ1tcInJlZ2lzdHJhdGlvbi51cmxcIl0sIG9uQ2hhbmdlOiBmdW5jdGlvbiAoZXYpIHsgX3RoaXMuc2F2ZVVSTChldi50YXJnZXQudmFsdWUpOyB9fSkpKSkpO1xuICAgICAgICB9O1xuICAgICAgICBSZWdpc3RlSW5mby5wcm90b3R5cGUuc2F2ZVVSTCA9IGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgICAgIHRoaXMucHJvcHMuZmxvdy5zYXZlKHZhbCk7XG4gICAgICAgICAgICB0aGlzLmZvcmNlVXBkYXRlKCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBSZWdpc3RlSW5mbztcbiAgICB9KFZpZXcuVmlldykpO1xuICAgIFZpZXcuUmVnaXN0ZUluZm8gPSBSZWdpc3RlSW5mbztcbn0pKFZpZXcgfHwgKFZpZXcgPSB7fSkpO1xuLyoqXG4gKiDphY3nva7lkJHlr7wt6K6+572u55So5oi35ZCR5a+85Li76KeG5Zu+44CCXG4gKlxuICogQGF1dGhvciAgICDlp5rlsKcgPHlhb2dhb3l1QHFxLmNvbT5cbiAqIEBmaWxlICAgICAgVmlldy9Db25maWdVc2VyLnRzXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9WaWV3LnRzXCIgLz5cbnZhciBWaWV3O1xuKGZ1bmN0aW9uIChWaWV3KSB7XG4gICAgdmFyIENvbmZpZ1VzZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoQ29uZmlnVXNlciwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gQ29uZmlnVXNlcihwcm9wcykge1xuICAgICAgICAgICAgX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpO1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5mbG93LnNWaWV3KHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIENvbmZpZ1VzZXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtjbGFzc05hbWU6ICd3cmFwJ30sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge2NsYXNzTmFtZTogJ3RpdGxlJ30sIFwi5q2l6aqk5Zub77ya5rOo5YaM55m75b2V55So5oi3XCIpLCBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtjbGFzc05hbWU6ICdkZXNjJ30sIFwi5rOo5YaM5LiA5Liq55So5oi355m75b2V5Yiw5pys57O757ufXCIpLCBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtjbGFzc05hbWU6ICdmb3JtV3JhcCd9LCBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtjbGFzc05hbWU6ICdyb3cnfSwgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7Y2xhc3NOYW1lOiAndGl0bGUnfSwgXCLnlKjmiLflkI1cIiksIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge2NsYXNzTmFtZTogJ2lucHV0J30sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiLCB7dHlwZTogJ3RleHQnLCBjbGFzc05hbWU6ICd1c2VyTmFtZSd9KSkpLCBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtjbGFzc05hbWU6ICdyb3cnfSwgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7Y2xhc3NOYW1lOiAndGl0bGUnfSwgXCLlr4bnoIFcIiksIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge2NsYXNzTmFtZTogJ2lucHV0J30sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiLCB7dHlwZTogJ3Bhc3N3b3JkJywgY2xhc3NOYW1lOiAndXNlclBzdyd9KSkpKSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBDb25maWdVc2VyO1xuICAgIH0oVmlldy5WaWV3KSk7XG4gICAgVmlldy5Db25maWdVc2VyID0gQ29uZmlnVXNlcjtcbn0pKFZpZXcgfHwgKFZpZXcgPSB7fSkpO1xuLyoqXG4gKiDphY3nva7lkJHlr7wt5a6M5oiQ5ZCR5a+85Li76KeG5Zu+44CCXG4gKlxuICogQGF1dGhvciAgICDlp5rlsKcgPHlhb2dhb3l1QHFxLmNvbT5cbiAqIEBmaWxlICAgICAgVmlldy9GaW5pc2gudHNcbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL1ZpZXcudHNcIiAvPlxudmFyIFZpZXc7XG4oZnVuY3Rpb24gKFZpZXcpIHtcbiAgICB2YXIgRmluaXNoID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKEZpbmlzaCwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gRmluaXNoKHByb3BzKSB7XG4gICAgICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcyk7XG4gICAgICAgICAgICB0aGlzLnByb3BzLmZsb3cuc1ZpZXcodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgRmluaXNoLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7Y2xhc3NOYW1lOiAnd3JhcCd9LCBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtjbGFzc05hbWU6ICd0aXRsZSd9LCBcIuatpemqpOS6lO+8muWujOaIkFwiKSwgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7Y2xhc3NOYW1lOiAnZGVzYyBmaW5pc2hEZXNjJ30sIFwi5oGt5Zac5oKo77yM6YWN572u5a6M5oiQ77yM6K+354K55Ye75a6M5oiQ5oyJ6ZKu6Lez6L2s5Yiw5ZCM5q2l5bel5YW36aaW6aG144CCXCIpKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIEZpbmlzaDtcbiAgICB9KFZpZXcuVmlldykpO1xuICAgIFZpZXcuRmluaXNoID0gRmluaXNoO1xufSkoVmlldyB8fCAoVmlldyA9IHt9KSk7XG4vKipcbiAqIOmFjee9ruWQkeWvvOW8leWvvOS4u+inhuWbvuOAglxuICpcbiAqIEBhdXRob3IgICAg5aea5bCnIDx5YW9nYW95dUBxcS5jb20+XG4gKiBAZmlsZSAgICAgIFZpZXcvU3RhZ2UudHNcbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIlZpZXcudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIl9TdGVwcy9Ob2RlQ2hvaWNlLnRzeFwiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiX1N0ZXBzL0NvbmZpZ0RCLnRzeFwiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiX1N0ZXBzL1JlZ2lzdGVJbmZvLnRzeFwiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiX1N0ZXBzL0NvbmZpZ1VzZXIudHN4XCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJfU3RlcHMvRmluaXNoLnRzeFwiIC8+XG52YXIgVmlldztcbihmdW5jdGlvbiAoVmlldykge1xuICAgIHZhciBTdGFnZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhTdGFnZSwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gU3RhZ2UocHJvcHMpIHtcbiAgICAgICAgICAgIF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKTtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICog5by55Ye65qGG6YWN572uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHRoaXMuYWxlcnRDb25mID0ge1xuICAgICAgICAgICAgICAgIGNhbmNlbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgdGl0bGU6ICfmj5DnpLonLFxuICAgICAgICAgICAgICAgIG9rVmFsdWU6ICfnoa7lrponLFxuICAgICAgICAgICAgICAgIG9rOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICog5o+Q56S65qGG6YWN572uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHRoaXMucHJvbXB0Q29uZiA9IHtcbiAgICAgICAgICAgICAgICBjYW5jZWw6IGZhbHNlXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5mbG93LnNWaWV3KHRoaXMpO1xuICAgICAgICAgICAgdmFyIGZsb3cgPSB0aGlzLnByb3BzLmZsb3c7XG4gICAgICAgICAgICB0aGlzLnN0ZXBWaWV3cyA9IFtcbiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFZpZXcuTm9kZUNob2ljZSwge2Zsb3c6IGZsb3cubWFrZSgnbm9kZUNob2ljZScpLCBjb25maWc6IGZsb3cuZ0NvbmZpZygpfSksXG4gICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChWaWV3LkNvbmZpZ0RCLCB7ZmxvdzogZmxvdy5tYWtlKCdjb25maWdEQicpLCBwYXJlbnRGbG93OiBmbG93LCBjb25maWc6IGZsb3cuZ0NvbmZpZygpfSksXG4gICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChWaWV3LlJlZ2lzdGVJbmZvLCB7ZmxvdzogZmxvdy5tYWtlKCdyZWdpc3RlSW5mbycpLCBjb25maWc6IGZsb3cuZ0NvbmZpZygpfSksXG4gICAgICAgICAgICAgICAgLy8gPENvbmZpZ1VzZXIgZmxvdz17Zmxvdy5tYWtlKCdjb25maWdVc2VyJyl9IGNvbmZpZz17Zmxvdy5nQ29uZmlnKCl9Lz4sXG4gICAgICAgICAgICAgICAgLy8gPENvbmZpZ1VzZXIgZmxvdz17Zmxvdy5tYWtlKCdjb25maWdVc2VyJyl9IGNvbmZpZz17Zmxvdy5nQ29uZmlnKCl9Lz4sXG4gICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChWaWV3LkZpbmlzaCwge2Zsb3c6IGZsb3cubWFrZSgnZmluaXNoJyksIHBhcmVudEZsb3c6IGZsb3csIGNvbmZpZzogZmxvdy5nQ29uZmlnKCl9KVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgICAgICBTdGFnZS5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHZhciBmbG93ID0gdGhpcy5wcm9wcy5mbG93O1xuICAgICAgICAgICAgdmFyIHByZXZpb3VzU3R5bGUgPSAnYnRuIHN0YWdlQnRuJyArIChmbG93LmdTdGVwSW5kZXgoKSA8PSAwID8gJyBkaXNhYmxlZCcgOiAnJyk7XG4gICAgICAgICAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7Y2xhc3NOYW1lOiAnc3RhZ2UnfSwgUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7Y2xhc3NOYW1lOiAncGhhc2UgdG9wJ30sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIHtjbGFzc05hbWU6ICd0aXRsZSd9LCBcIuWQjOatpeW3peWFt+mFjee9ruWQkeWvvFwiKSksIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwge2NsYXNzTmFtZTogJ3BoYXNlIHN0YWdlV3JhcCd9LCB0aGlzLnN0ZXBWaWV3c1tmbG93LmdTdGVwSW5kZXgoKV0pLCBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtjbGFzc05hbWU6ICdwaGFzZSBib3R0b20nfSwgZmxvdy5nU3RlcEluZGV4KCkgPT0gMSA/XG4gICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwge2NsYXNzTmFtZTogJ2xlZnQgYnRuV3JhcCd9LCBSZWFjdC5jcmVhdGVFbGVtZW50KFwic3BhblwiLCB7Y2xhc3NOYW1lOiAnYnRuIHN0YWdlQnRuJywgb25DbGljazogZnVuY3Rpb24gKCkgeyBfdGhpcy50ZXN0Q29ubigpOyB9fSwgUmVhY3QuY3JlYXRlRWxlbWVudChcInBcIiwgbnVsbCwgXCLmtYvor5Xov57mjqVcIikpKSA6XG4gICAgICAgICAgICAgICAgJycsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIHtjbGFzc05hbWU6ICdyaWdodCBidG5XcmFwJ30sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIHtjbGFzc05hbWU6IHByZXZpb3VzU3R5bGUsIG9uQ2xpY2s6IGZ1bmN0aW9uIChldikgeyBmbG93LnByZXZpb3VzKGV2KTsgfX0sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJwXCIsIG51bGwsIFwi5LiK5LiA5q2lXCIpKSwgZmxvdy5nU3RlcEluZGV4KCkgPj0gdGhpcy5zdGVwVmlld3MubGVuZ3RoIC0gMSA/XG4gICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwge2NsYXNzTmFtZTogJ2J0biBzdGFnZUJ0bicsIG9uQ2xpY2s6IGZ1bmN0aW9uIChldikgeyBmbG93Lm1ha2UoXCJmaW5pc2hcIikuZmluaXNoKCk7IH19LCBSZWFjdC5jcmVhdGVFbGVtZW50KFwicFwiLCBudWxsLCBcIuWujOaIkFwiKSkgOlxuICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIHtjbGFzc05hbWU6ICdidG4gc3RhZ2VCdG4nLCBvbkNsaWNrOiBmdW5jdGlvbiAoZXYpIHsgZmxvdy5uZXh0KGV2KTsgfX0sIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJwXCIsIG51bGwsIFwi5LiL5LiA5q2lXCIpKSkpKTtcbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOa1i+ivleaVsOaNruW6k+i/nuaOpVxuICAgICAgICAgKi9cbiAgICAgICAgU3RhZ2UucHJvdG90eXBlLnRlc3RDb25uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGFsZXJ0RGlhbG9nID0gZGlhbG9nKHRoaXMuYWxlcnRDb25mKTtcbiAgICAgICAgICAgIHZhciBkYlR5cGUgPSB0aGlzLnByb3BzLmZsb3cuZ0NvbmZpZygpWydkYi50eXBlJ107XG4gICAgICAgICAgICB2YXIgZGJEcml2ZXIgPSB0aGlzLnByb3BzLmZsb3cuZ0NvbmZpZygpWydkYi5kcml2ZXInXTtcbiAgICAgICAgICAgIHZhciBkYlVybCA9IHRoaXMucHJvcHMuZmxvdy5nQ29uZmlnKClbJ2RiLnVybCddO1xuICAgICAgICAgICAgdmFyIGRiVXNlciA9IHRoaXMucHJvcHMuZmxvdy5nQ29uZmlnKClbJ2RiLnVzZXInXTtcbiAgICAgICAgICAgIHZhciBkYlBzdyA9IHRoaXMucHJvcHMuZmxvdy5nQ29uZmlnKClbJ2RiLnBzdyddO1xuICAgICAgICAgICAgaWYgKCFkYlR5cGUgfHwgIWRiRHJpdmVyIHx8ICFkYlVybCB8fCAhZGJVc2VyIHx8ICFkYlBzdykge1xuICAgICAgICAgICAgICAgIGFsZXJ0RGlhbG9nLmNvbnRlbnQoXCI8c3BhbiBjbGFzcz0nYWxlcnQnPjxzcGFuIGNsYXNzPSdpY29uIGljb24tbm90aWZpY2F0aW9uJz48L3NwYW4+PHNwYW4gY2xhc3M9J3RpdGxlJz7or7flrozmiJDmlbDmja7lupPphY3nva48L3NwYW4+XCIpO1xuICAgICAgICAgICAgICAgIGFsZXJ0RGlhbG9nLnNob3dNb2RhbCgpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBwcm9tcHQgPSBkaWFsb2codGhpcy5wcm9tcHRDb25mKTtcbiAgICAgICAgICAgIHByb21wdC5jb250ZW50KFwi5q2j5Zyo5rWL6K+V5pWw5o2u5bqT6L+e5o6l77yM6K+356iN5YCZ44CCXCIpO1xuICAgICAgICAgICAgcHJvbXB0LnNob3dNb2RhbCgpO1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5mbG93LmNvbm5UZXN0KCkudGhlbihmdW5jdGlvbiAoaXNTdWMpIHtcbiAgICAgICAgICAgICAgICBwcm9tcHQuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICBpZiAoIWlzU3VjKSB7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0RGlhbG9nLmNvbnRlbnQoXCI8c3BhbiBjbGFzcz0nYWxlcnQnPjxzcGFuIGNsYXNzPSdpY29uIGljb24tbm90aWZpY2F0aW9uJz48L3NwYW4+PHNwYW4gY2xhc3M9J3RpdGxlJz7ov57mjqXlpLHotKU8L3NwYW4+XCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnREaWFsb2cuY29udGVudChcIjxzcGFuIGNsYXNzPSdhbGVydCc+PHNwYW4gY2xhc3M9J2ljb24gaWNvbi1ub3RpZmljYXRpb24nPjwvc3Bhbj48c3BhbiBjbGFzcz0ndGl0bGUnPui/nuaOpeaIkOWKnzwvc3Bhbj5cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFsZXJ0RGlhbG9nLnNob3dNb2RhbCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBTdGFnZTtcbiAgICB9KFZpZXcuVmlldykpO1xuICAgIFZpZXcuU3RhZ2UgPSBTdGFnZTtcbn0pKFZpZXcgfHwgKFZpZXcgPSB7fSkpO1xuLyoqXG4gKiDlrprkuYnnvJbovpHlmajlvILluLjjgIJcbiAqXG4gKiBAYXV0aG9yICAgIOWnmuWwpyA8eWFvZ2FveXVAcXEuY29tPlxuICogQGZpbGUgICAgICBFLnRzXG4gKi9cbnZhciBFID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoRSwgX3N1cGVyKTtcbiAgICAvKipcbiAgICAgKiDmnoTpgKDlh73mlbDjgIJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBFKG1lc3NhZ2UpIHtcbiAgICAgICAgX3N1cGVyLmNhbGwodGhpcyk7XG4gICAgICAgIGlmICgnY2FwdHVyZVN0YWNrVHJhY2UnIGluIEVycm9yKVxuICAgICAgICAgICAgRXJyb3JbJ2NhcHR1cmVTdGFja1RyYWNlJ10odGhpcywgRSk7XG4gICAgICAgIHRoaXMubmFtZSA9ICdFcnJvcic7XG4gICAgICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgfVxuICAgIEUuVVRJTF9SRU1PVEVfVElNRU9VVCA9ICfov5znq6/or7fmsYLotoXml7YnO1xuICAgIHJldHVybiBFO1xufShFcnJvcikpO1xuLyoqXG4gKiDlo7DmmI7miJDlip/lm57osIPlh73mlbDmjqXlj6Pop4TojIPjgIJcbiAqXG4gKiBAYXV0aG9yICAgIOWnmuWwpyA8eWFvZ2FveXVAMTYzLmNvbT5cbiAqIEBsaWNlbnNlICAgR1BMLTMuMFxuICogQGZpbGUgICAgICBVdGlsL0lTdWNjZXNzQ2FsbGJhY2sudHNcbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIklIYXNoVGFibGUudHNcIiAvPlxuLyoqXG4gKiDlo7DmmI7lpLHotKXlm57osIPlh73mlbDmjqXlj6Pop4TojIPjgIJcbiAqXG4gKiBAYXV0aG9yICAgIOWnmuWwpyA8eWFvZ2FveXVAMTYzLmNvbT5cbiAqIEBjb3B5cmlnaHQgwqkgMjAxNSBEYWhhby5kZVxuICogQGxpY2Vuc2UgICBHUEwtMy4wXG4gKiBAZmlsZSAgICAgIFV0aWwvSUZhaWx1cmVDYWxsYmFjay50c1xuICovXG4vKipcbiAqIOWumuS5iei/nOerr+mAmuS/oee7hOS7tuOAglxuICpcbiAqIEBhdXRob3IgICAg5aea5bCnIDx5YW9nYW95dUAxNjMuY29tPlxuICogQGxpY2Vuc2UgICBHUEwtMy4wXG4gKiBAZmlsZSAgICAgIFV0aWwvUmVtb3RlLnRzXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9FLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJJU3VjY2Vzc0NhbGxiYWNrLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJJRmFpbHVyZUNhbGxiYWNrLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJfaXRlcmF0b3IudHNcIiAvPlxudmFyIFV0aWw7XG4oZnVuY3Rpb24gKFV0aWwpIHtcbiAgICB2YXIgeGRycyA9IFtdO1xuICAgIHZhciBSZW1vdGU7XG4gICAgKGZ1bmN0aW9uIChSZW1vdGUpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOagvOW8j+WMluOAglxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZm9ybWF0KHVybCkge1xuICAgICAgICAgICAgcmV0dXJuIGxvY2F0aW9uLnByb3RvY29sICsgdXJsLnJlcGxhY2UoL14uK1xcL1xcLy8sICcvLycpLnJlcGxhY2UoL1xcPy4qJC8sICcnKTtcbiAgICAgICAgfVxuICAgICAgICBSZW1vdGUuZm9ybWF0ID0gZm9ybWF0O1xuICAgICAgICAvKipcbiAgICAgICAgICogSFRUUCBHRVQg6L+c56uv5pWw5o2u44CCXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXQodXJsLCBvblN1Y2Nlc3MsIG9uRmFpbHVyZSkge1xuICAgICAgICAgICAgaHR0cChNZXRob2QuR0VULCB1cmwsIHt9LCBvblN1Y2Nlc3MsIG9uRmFpbHVyZSk7XG4gICAgICAgIH1cbiAgICAgICAgUmVtb3RlLmdldCA9IGdldDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEhUVFAgUE9TVCDov5znq6/mlbDmja7jgIJcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHBvc3QodXJsLCBkYXRhLCBvblN1Y2Nlc3MsIG9uRmFpbHVyZSkge1xuICAgICAgICAgICAgaHR0cChNZXRob2QuUE9TVCwgdXJsLCBkYXRhLCBvblN1Y2Nlc3MsIG9uRmFpbHVyZSk7XG4gICAgICAgIH1cbiAgICAgICAgUmVtb3RlLnBvc3QgPSBwb3N0O1xuICAgICAgICAvKipcbiAgICAgICAgICogSFRUUCDor7fmsYLmlrnms5XjgIJcbiAgICAgICAgICovXG4gICAgICAgIChmdW5jdGlvbiAoTWV0aG9kKSB7XG4gICAgICAgICAgICBNZXRob2RbTWV0aG9kW1wiR0VUXCJdID0gMF0gPSBcIkdFVFwiO1xuICAgICAgICAgICAgTWV0aG9kW01ldGhvZFtcIlBPU1RcIl0gPSAxXSA9IFwiUE9TVFwiO1xuICAgICAgICB9KShSZW1vdGUuTWV0aG9kIHx8IChSZW1vdGUuTWV0aG9kID0ge30pKTtcbiAgICAgICAgdmFyIE1ldGhvZCA9IFJlbW90ZS5NZXRob2Q7XG4gICAgICAgIDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEhUVFAg6K+35rGC6L+c56uv5pWw5o2u44CCXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBodHRwKG1ldGhvZCwgdXJsLCBkYXRhLCBvblN1Y2Nlc3MsIG9uRmFpbHVyZSkge1xuICAgICAgICAgICAgdmFyIHFzID0gW10sIHhocjtcbiAgICAgICAgICAgIGlmICgndW5kZWZpbmVkJyAhPSB0eXBlb2YgWERvbWFpblJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICB4aHIgPSBuZXcgWERvbWFpblJlcXVlc3QoKTtcbiAgICAgICAgICAgICAgICB4ZHJzLnB1c2goeGhyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3AgPSBKU09OLnBhcnNlKHhoci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoJ3JlYXNvbicgaW4gcmVzcClcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFKHJlc3BbJ3JlYXNvbiddKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCdzdGF0dXMnIGluIHhociAmJiAyMDAgIT0geGhyLnN0YXR1cylcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFKHhoci5zdGF0dXNUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgb25TdWNjZXNzKHJlc3ApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCdjb250ZXh0JyBpbiByZXNwKVxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JbXCJjb250ZXh0XCJdID0gcmVzcFtcImNvbnRleHRcIl07XG4gICAgICAgICAgICAgICAgICAgIG9uRmFpbHVyZShlcnJvciwgeGhyLnN0YXR1cyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHhoci5vbnByb2dyZXNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgeGhyLm9uZXJyb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBvbkZhaWx1cmUoZXZlbnQuZXJyb3IpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHhoci5vbnRpbWVvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgb25GYWlsdXJlKG5ldyBFKEUuVVRJTF9SRU1PVEVfVElNRU9VVCkpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIC8vIHhoci50aW1lb3V0ID0gMzAwMDA7XG4gICAgICAgICAgICB4aHIub3BlbihNZXRob2QuR0VUID09IG1ldGhvZCA/ICdHRVQnIDogJ1BPU1QnLCBmb3JtYXQodXJsKSwgdHJ1ZSk7XG4gICAgICAgICAgICBVdGlsLmVhY2goZGF0YSwgZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgICAgICAgICBxcy5wdXNoKGtleSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAocXMubGVuZ3RoICYmICdzZXRSZXF1ZXN0SGVhZGVyJyBpbiB4aHIpXG4gICAgICAgICAgICAgICAgeGhyWydzZXRSZXF1ZXN0SGVhZGVyJ10oJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnKTtcbiAgICAgICAgICAgIHhoci5zZW5kKHFzLmxlbmd0aCA/IHFzLmpvaW4oJyYnKSA6IG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIFJlbW90ZS5odHRwID0gaHR0cDtcbiAgICB9KShSZW1vdGUgPSBVdGlsLlJlbW90ZSB8fCAoVXRpbC5SZW1vdGUgPSB7fSkpO1xufSkoVXRpbCB8fCAoVXRpbCA9IHt9KSk7XG4vKipcbiAqIOWjsOaYjuW8leWvvOeoi+W6j+S4muWKoea1geaOpeWPo+inhOiMg+OAglxuICpcbiAqIEBhdXRob3IgICAg5aea5bCnIDx5YW9nYW95dUBxcS5jb20+XG4gKiBAZmlsZSAgICAgIENvcmUvX1J1bnRpbWUvSVN0YWdlRmxvdy50c1xuICovXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiSUZsb3cudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL19WaWV3L0lWaWV3LnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi9VdGlsL1JlbW90ZS50c1wiIC8+XG4vKipcbiAqIOWjsOaYjumFjee9ruWujOaIkOWujOaIkOS4muWKoea1geaOpeWPo+inhOiMg+OAglxuICpcbiAqIEBhdXRob3IgICAg5aea5bCnIDx5YW9nYW95dUBxcS5jb20+XG4gKiBAZmlsZSAgICAgIENvcmUvX1J1bnRpbWUvSUZpbmlzaEZsb3cudHNcbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIklGbG93LnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9fVmlldy9JVmlldy50c1wiIC8+XG4vKipcbiAqIOWjsOaYjuiKgueCueexu+Wei+mAieaLqeS4muWKoea1geaOpeWPo+inhOiMg+OAglxuICpcbiAqIEBhdXRob3IgICAg5aea5bCnIDx5YW9nYW95dUBxcS5jb20+XG4gKiBAZmlsZSAgICAgIENvcmUvX1J1bnRpbWUvSU5vZGVDaG9pY2VGbG93LnRzXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJJU3RlcEZsb3cudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL19WaWV3L0lWaWV3LnRzXCIgLz5cbi8qKlxuICog6IqC54K557G75Z6L6YCJ5oup5a6e5L2T44CCXG4gKlxuICogQGF1dGhvciAgICDlp5rlsKcgPHlhb2dhb3l1QHFxLmNvbT5cbiAqIEBmaWxlICAgICAgUnVudGltZS9Ob2RlQ2hvaWNlRmxvdy50c1xuICovXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vRmxvdy50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vQ29yZS9fUnVudGltZS9JTm9kZUNob2ljZUZsb3cudHNcIiAvPlxudmFyIFJ1bnRpbWU7XG4oZnVuY3Rpb24gKFJ1bnRpbWUpIHtcbiAgICB2YXIgTm9kZUNob2ljZUZsb3cgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoTm9kZUNob2ljZUZsb3csIF9zdXBlcik7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiDmnoTpgKDlh73mlbDjgIJcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIE5vZGVDaG9pY2VGbG93KGNvbmZpZykge1xuICAgICAgICAgICAgX3N1cGVyLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB0aGlzLmFsZXJ0Q29uZiA9IHtcbiAgICAgICAgICAgICAgICBjYW5jZWw6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRpdGxlOiAn5o+Q56S6JyxcbiAgICAgICAgICAgICAgICBva1ZhbHVlOiAn56Gu5a6aJyxcbiAgICAgICAgICAgICAgICBvazogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICog6IqC54K557G75Z6L6YCJ5oup5Lia5YqhXG4gICAgICAgICAqL1xuICAgICAgICBOb2RlQ2hvaWNlRmxvdy5wcm90b3R5cGUuY2hvaWNlVHlwZSA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgICAgICB0aGlzLmNvbmZpZ1sndHlwZSddID0gdHlwZTtcbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOatpemqpOmqjOivgVxuICAgICAgICAgKi9cbiAgICAgICAgTm9kZUNob2ljZUZsb3cucHJvdG90eXBlLnZhbGlkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmNvbmZpZ1sndHlwZSddKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFsZXJ0RGlhbG9nID0gZGlhbG9nKHRoaXMuYWxlcnRDb25mKTtcbiAgICAgICAgICAgICAgICBhbGVydERpYWxvZy5jb250ZW50KFwiPHNwYW4gY2xhc3M9J2FsZXJ0Jz48c3BhbiBjbGFzcz0naWNvbiBpY29uLW5vdGlmaWNhdGlvbic+PC9zcGFuPjxzcGFuIGNsYXNzPSd0aXRsZSc+6K+36YCJ5oup5LiA5Liq6IqC54K557G75Z6L44CCPC9zcGFuPlwiKTtcbiAgICAgICAgICAgICAgICBhbGVydERpYWxvZy5zaG93TW9kYWwoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIE5vZGVDaG9pY2VGbG93O1xuICAgIH0oUnVudGltZS5GbG93KSk7XG4gICAgUnVudGltZS5Ob2RlQ2hvaWNlRmxvdyA9IE5vZGVDaG9pY2VGbG93O1xufSkoUnVudGltZSB8fCAoUnVudGltZSA9IHt9KSk7XG4vKipcbiAqIOWjsOaYjuaVsOaNruW6k+mFjee9ruS4muWKoea1geaOpeWPo+inhOiMg+OAglxuICpcbiAqIEBhdXRob3IgICAg5aea5bCnIDx5YW9nYW95dUBxcS5jb20+XG4gKiBAZmlsZSAgICAgIENvcmUvX1J1bnRpbWUvSUNvbmZpZ0RCRmxvdy50c1xuICovXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiSVN0ZXBGbG93LnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9fVmlldy9JVmlldy50c1wiIC8+XG4vKipcbiAqIOWumuS5ie+8iOi/kOihjOaXtu+8ieS6i+S7tue7hOS7tuOAglxuICpcbiAqIEBhdXRob3IgICAg6YOR54Wc5a6HIDx5emhlbmdAYXRmYWNnLmNvbT5cbiAqIEBjb3B5cmlnaHQgwqkgMjAxNSBEYWhhby5kZVxuICogQGxpY2Vuc2UgICBHUEwtMy4wXG4gKiBAZmlsZSAgICAgIEV2L0V2ZW50LnRzXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9Db3JlL19Fdi9JRXZlbnQudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL0NvcmUvX1J1bnRpbWUvSUZsb3cudHNcIiAvPlxudmFyIEV2O1xuKGZ1bmN0aW9uIChFdikge1xuICAgIHZhciBFdmVudCA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiDmnoTpgKDlh73mlbDjgIJcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIEV2ZW50KG1ldGFzKSB7XG4gICAgICAgICAgICB0aGlzLnRhcmdldCA9IG1ldGFzLnRhcmdldDtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICog6I635Y+W57G75Z6L44CCXG4gICAgICAgICAqL1xuICAgICAgICBFdmVudC5wcm90b3R5cGUuZ1R5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBFdmVudDtcbiAgICB9KCkpO1xuICAgIEV2LkV2ZW50ID0gRXZlbnQ7XG59KShFdiB8fCAoRXYgPSB7fSkpO1xuLyoqXG4gKiDlo7DmmI7vvIjov5DooYzml7bvvInnlLvpnaLkuovku7bmjqXlj6Pop4TojIPjgIJcbiAqXG4gKiBAYXV0aG9yICAgIOWnmuWwpyA8eXlhb0BhdGZhY2cuY29tPlxuICogQGNvcHlyaWdodCDCqSAyMDE1IERhaGFvLmRlXG4gKiBAbGljZW5zZSAgIEdQTC0zLjBcbiAqIEBmaWxlICAgICAgRXYvSUNvbnRyb2xNZXRhcy50c1xuICovXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vQ29yZS9fRXYvSUV2ZW50TWV0YXMudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL0NvcmUvX1J1bnRpbWUvSVN0YWdlRmxvdy50c1wiIC8+XG4vKipcbiAqIOWumuS5ie+8iOi/kOihjOaXtu+8ieeUu+mdouWHuueOsOmAieaLqeS/oeaBr+S6i+S7tue7hOS7tuOAglxuICpcbiAqIEBhdXRob3IgICAg5aea5bCnIDx5eWFvQGF0ZmFjZy5jb20+XG4gKiBAY29weXJpZ2h0IMKpIDIwMTUgRGFoYW8uZGVcbiAqIEBsaWNlbnNlICAgR1BMLTMuMFxuICogQGZpbGUgICAgICBFdi9DaG9pY2UudHNcbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkV2ZW50LnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJJU3RlcE1ldGFzLnRzXCIgLz5cbnZhciBFdjtcbihmdW5jdGlvbiAoRXYpIHtcbiAgICB2YXIgU3RlcCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhTdGVwLCBfc3VwZXIpO1xuICAgICAgICAvKipcbiAgICAgICAgICog5p6E6YCg5Ye95pWw44CCXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBTdGVwKG1ldGFzKSB7XG4gICAgICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBtZXRhcyk7XG4gICAgICAgICAgICB0aGlzLnR5cGUgPSBtZXRhcy50eXBlO1xuICAgICAgICAgICAgdGhpcy5jYWxsYmFjayA9IG1ldGFzLmNhbGxiYWNrO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiDojrflj5bnsbvlnovjgIJcbiAgICAgICAgICovXG4gICAgICAgIFN0ZXAucHJvdG90eXBlLmdUeXBlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICdzdGVwJztcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFN0ZXA7XG4gICAgfShFdi5FdmVudCkpO1xuICAgIEV2LlN0ZXAgPSBTdGVwO1xufSkoRXYgfHwgKEV2ID0ge30pKTtcbi8qKlxuICog5pWw5o2u5bqT6YWN572u5a6e5L2T44CCXG4gKlxuICogQGF1dGhvciAgICDlp5rlsKcgPHlhb2dhb3l1QHFxLmNvbT5cbiAqIEBmaWxlICAgICAgUnVudGltZS9Db25maWdEQkZsb3cudHNcbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL0Zsb3cudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL0NvcmUvX1J1bnRpbWUvSUNvbmZpZ0RCRmxvdy50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vRXYvU3RlcC50c1wiIC8+XG52YXIgUnVudGltZTtcbihmdW5jdGlvbiAoUnVudGltZSkge1xuICAgIHZhciBDb25maWdEQkZsb3cgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoQ29uZmlnREJGbG93LCBfc3VwZXIpO1xuICAgICAgICAvKipcbiAgICAgICAgICog5p6E6YCg5Ye95pWw44CCXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBDb25maWdEQkZsb3coY29uZmlnKSB7XG4gICAgICAgICAgICBfc3VwZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuZGF0YWJhc2VzID0ge1xuICAgICAgICAgICAgICAgICdPcmFjbGUnOiB7ICdkcml2ZXInOiAnb3JhY2xlLmpkYmMuZHJpdmVyLk9yYWNsZURyaXZlcicsICd1cmwnOiAnamRiYzpvcmFjbGU6dGhpbjpAMTI3LjAuMC4xOjE1MjE6ZGF0YWJhc2VuYW1lJyB9LFxuICAgICAgICAgICAgICAgICdTUUwgU2VydmVyJzogeyAnZHJpdmVyJzogJ25ldC5zb3VyY2Vmb3JnZS5qdGRzLmpkYmMuRHJpdmVyJywgJ3VybCc6ICdqZGJjOmp0ZHM6c3Fsc2VydmVyOi8vaG9zdG5hbWUvZGF0YWJhc2VuYW1lO3VzZUN1cnNvcnM9dHJ1ZTtidWZmZXJNYXhNZW1vcnk9MTAyNDA7bG9iQnVmZmVyPTUyNDI4ODA7c29ja2V0VGltZW91dD0zMDA7YXBwTmFtZT1zeW5jZGInIH0sXG4gICAgICAgICAgICAgICAgJ0RCMic6IHsgJ2RyaXZlcic6ICdjb20uaWJtLmRiMi5qY2MuREIyRHJpdmVyJywgJ3VybCc6ICdqZGJjOmRiMjovL2hvc3RuYW1lOjUwMDAwL2RhdGFiYXNlbmFtZScgfSxcbiAgICAgICAgICAgICAgICAnTXlzcWwnOiB7ICdkcml2ZXInOiAnY29tLm15c3FsLmpkYmMuRHJpdmVyJywgJ3VybCc6ICdqZGJjOm15c3FsOi8vaG9zdG5hbWUvZGF0YWJhc2VuYW1lP3RpbnlJbnQxaXNCaXQ9ZmFsc2UmemVyb0RhdGVUaW1lQmVoYXZpb3I9Y29udmVydFRvTnVsbCcgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICog5by55Ye65qGG6YWN572uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHRoaXMuYWxlcnRDb25mID0ge1xuICAgICAgICAgICAgICAgIGNhbmNlbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgdGl0bGU6ICfmj5DnpLonLFxuICAgICAgICAgICAgICAgIG9rVmFsdWU6ICfnoa7lrponLFxuICAgICAgICAgICAgICAgIG9rOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICog5o+Q56S65qGG6YWN572uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHRoaXMucHJvbXB0Q29uZiA9IHtcbiAgICAgICAgICAgICAgICBjYW5jZWw6IGZhbHNlXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy53aXpDb25maWcgPSBjb25maWc7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOatpemqpOmqjOivgVxuICAgICAgICAgKi9cbiAgICAgICAgQ29uZmlnREJGbG93LnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLnRlc3RDb25uKGZ1bmN0aW9uIChpc1Rlc3RTdWMpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNUZXN0U3VjKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnZpZXcucHJvcHMucGFyZW50Rmxvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdi5TdGVwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogX3RoaXMudmlldy5wcm9wcy5wYXJlbnRGbG93LFxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJkYi5uZXh0XCJcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9O1xuICAgICAgICBDb25maWdEQkZsb3cucHJvdG90eXBlLmdldERhdGFiYXNlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRhdGFiYXNlcztcbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOa1i+ivleaVsOaNruW6k+i/nuaOpVxuICAgICAgICAgKi9cbiAgICAgICAgQ29uZmlnREJGbG93LnByb3RvdHlwZS50ZXN0Q29ubiA9IGZ1bmN0aW9uIChjYikge1xuICAgICAgICAgICAgdmFyIGFsZXJ0RGlhbG9nID0gZGlhbG9nKHRoaXMuYWxlcnRDb25mKTtcbiAgICAgICAgICAgIHZhciBkYlR5cGUgPSB0aGlzLndpekNvbmZpZ1snZGIudHlwZSddO1xuICAgICAgICAgICAgdmFyIGRiRHJpdmVyID0gdGhpcy53aXpDb25maWdbJ2RiLmRyaXZlciddO1xuICAgICAgICAgICAgdmFyIGRiVXJsID0gdGhpcy53aXpDb25maWdbJ2RiLnVybCddO1xuICAgICAgICAgICAgdmFyIGRiVXNlciA9IHRoaXMud2l6Q29uZmlnWydkYi51c2VyJ107XG4gICAgICAgICAgICB2YXIgZGJQc3cgPSB0aGlzLndpekNvbmZpZ1snZGIucHN3J107XG4gICAgICAgICAgICBpZiAoIWRiVHlwZSB8fCAhZGJEcml2ZXIgfHwgIWRiVXJsIHx8ICFkYlVzZXIgfHwgIWRiUHN3KSB7XG4gICAgICAgICAgICAgICAgYWxlcnREaWFsb2cuY29udGVudChcIjxzcGFuIGNsYXNzPSdhbGVydCc+PHNwYW4gY2xhc3M9J2ljb24gaWNvbi1ub3RpZmljYXRpb24nPjwvc3Bhbj48c3BhbiBjbGFzcz0ndGl0bGUnPuivt+WujOaIkOaVsOaNruW6k+mFjee9rjwvc3Bhbj5cIik7XG4gICAgICAgICAgICAgICAgYWxlcnREaWFsb2cuc2hvd01vZGFsKCk7XG4gICAgICAgICAgICAgICAgY2IoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHByb21wdCA9IGRpYWxvZyh0aGlzLnByb21wdENvbmYpO1xuICAgICAgICAgICAgcHJvbXB0LmNvbnRlbnQoXCLmraPlnKjmtYvor5XmlbDmja7lupPov57mjqXvvIzor7fnqI3lgJnjgIJcIik7XG4gICAgICAgICAgICBwcm9tcHQuc2hvd01vZGFsKCk7XG4gICAgICAgICAgICB0aGlzLnZpZXcucHJvcHMucGFyZW50Rmxvdy5jb25uVGVzdCgpLnRoZW4oZnVuY3Rpb24gKGlzU3VjKSB7XG4gICAgICAgICAgICAgICAgcHJvbXB0LmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgaWYgKCFpc1N1Yykge1xuICAgICAgICAgICAgICAgICAgICBhbGVydERpYWxvZy5jb250ZW50KFwiPHNwYW4gY2xhc3M9J2FsZXJ0Jz48c3BhbiBjbGFzcz0naWNvbiBpY29uLW5vdGlmaWNhdGlvbic+PC9zcGFuPjxzcGFuIGNsYXNzPSd0aXRsZSc+6L+e5o6l5aSx6LSlPC9zcGFuPlwiKTtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnREaWFsb2cuc2hvd01vZGFsKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNiKGlzU3VjKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gQ29uZmlnREJGbG93O1xuICAgIH0oUnVudGltZS5GbG93KSk7XG4gICAgUnVudGltZS5Db25maWdEQkZsb3cgPSBDb25maWdEQkZsb3c7XG59KShSdW50aW1lIHx8IChSdW50aW1lID0ge30pKTtcbi8qKlxuICog5aOw5piO6IqC54K55rOo5YaM5Lia5Yqh5rWB5o6l5Y+j6KeE6IyD44CCXG4gKlxuICogQGF1dGhvciAgICDlp5rlsKcgPHlhb2dhb3l1QHFxLmNvbT5cbiAqIEBmaWxlICAgICAgQ29yZS9fUnVudGltZS9JUmVnaXN0ZUluZm9GbG93LnRzXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJJU3RlcEZsb3cudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL19WaWV3L0lWaWV3LnRzXCIgLz5cbi8qKlxuICog6IqC54K55rOo5YaM5L+h5oGv5a6e5L2T44CCXG4gKlxuICogQGF1dGhvciAgICDlp5rlsKcgPHlhb2dhb3l1QHFxLmNvbT5cbiAqIEBmaWxlICAgICAgUnVudGltZS9SZWdpc3RlSW5mb0Zsb3cudHNcbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL0Zsb3cudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL0NvcmUvX1J1bnRpbWUvSVJlZ2lzdGVJbmZvRmxvdy50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vU3RhZ2VGbG93LnRzeFwiIC8+XG52YXIgUnVudGltZTtcbihmdW5jdGlvbiAoUnVudGltZSkge1xuICAgIHZhciBSZWdpc3RlSW5mb0Zsb3cgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoUmVnaXN0ZUluZm9GbG93LCBfc3VwZXIpO1xuICAgICAgICAvKipcbiAgICAgICAgICog5p6E6YCg5Ye95pWw44CCXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBSZWdpc3RlSW5mb0Zsb3coY29uZmlnKSB7XG4gICAgICAgICAgICBfc3VwZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICog5by55Ye65qGG6YWN572uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHRoaXMuYWxlcnRDb25mID0ge1xuICAgICAgICAgICAgICAgIGNhbmNlbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgdGl0bGU6ICfmj5DnpLonLFxuICAgICAgICAgICAgICAgIG9rVmFsdWU6ICfnoa7lrponLFxuICAgICAgICAgICAgICAgIG9rOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMud2l6Q29uZmlnID0gY29uZmlnO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiDkv53lrZjku47lupPorr7nva7nmoTlkIzmraXmjqXlj6NVUkxcbiAgICAgICAgICovXG4gICAgICAgIFJlZ2lzdGVJbmZvRmxvdy5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICAgICAgICAgIHRoaXMud2l6Q29uZmlnWydyZWdpc3RyYXRpb24udXJsJ10gPSB1cmw7XG4gICAgICAgIH07XG4gICAgICAgIC8qKlxuICAgICAgICAgKiDnlJ/miJDkuLvnq6/nmoTlkIzmraXmjqXlj6NVUkxcbiAgICAgICAgICovXG4gICAgICAgIFJlZ2lzdGVJbmZvRmxvdy5wcm90b3R5cGUuZ2VuU3luY1VSTCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjb250ZXh0UGF0aCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcFwiKS5nZXRBdHRyaWJ1dGUoXCJyZWZcIik7XG4gICAgICAgICAgICB2YXIgbG9jYWwgPSB3aW5kb3cubG9jYXRpb247XG4gICAgICAgICAgICByZXR1cm4gbG9jYWwucHJvdG9jb2wgKyBcIjovL1wiICsgbG9jYWwuaG9zdCArIGNvbnRleHRQYXRoICsgXCIvc3luYy9cIiArIFJ1bnRpbWUuU3RhZ2VGbG93LkVOR0lORV9OQU1FO1xuICAgICAgICB9O1xuICAgICAgICAvKipcbiAgICAgICAgICog5q2l6aqk6aqM6K+BXG4gICAgICAgICAqL1xuICAgICAgICBSZWdpc3RlSW5mb0Zsb3cucHJvdG90eXBlLnZhbGlkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMud2l6Q29uZmlnWyd0eXBlJ10gPT0gJ21hc3RlcicpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICBpZiAoIXRoaXMud2l6Q29uZmlnWydyZWdpc3RyYXRpb24udXJsJ10gfHwgLyheXFxzKyl8KFxccyskKS9pZy50ZXN0KHRoaXMud2l6Q29uZmlnWydyZWdpc3RyYXRpb24udXJsJ10pKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFsZXJ0XzEgPSBkaWFsb2codGhpcy5hbGVydENvbmYpO1xuICAgICAgICAgICAgICAgIC8vIDxzcGFuIGNsYXNzPSdhbGVydCc+PHNwYW4gY2xhc3M9J2ljb24gaWNvbi1ub3RpZmljYXRpb24nPjwvc3Bhbj48c3BhbiBjbGFzcz0ndGl0bGUnPui/nuaOpeWksei0pTwvc3Bhbj5cbiAgICAgICAgICAgICAgICBhbGVydF8xLmNvbnRlbnQoXCI8c3BhbiBjbGFzcz0nYWxlcnQnPjxzcGFuIGNsYXNzPSdpY29uIGljb24tbm90aWZpY2F0aW9uJz48L3NwYW4+PHNwYW4gY2xhc3M9J3RpdGxlJz7kuLvlupPoioLngrlVUkzloavlhpnkuI3mraPnoa7vvIzor7fmo4Dmn6XmiYDloavlhpnnmoTlhoXlrrnjgII8L3NwYW4+XCIpO1xuICAgICAgICAgICAgICAgIGFsZXJ0XzEuc2hvd01vZGFsKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBSZWdpc3RlSW5mb0Zsb3c7XG4gICAgfShSdW50aW1lLkZsb3cpKTtcbiAgICBSdW50aW1lLlJlZ2lzdGVJbmZvRmxvdyA9IFJlZ2lzdGVJbmZvRmxvdztcbn0pKFJ1bnRpbWUgfHwgKFJ1bnRpbWUgPSB7fSkpO1xuLyoqXG4gKiDlo7DmmI7kv53lrZjnmbvlvZXnlKjmiLfkuJrliqHmtYHmjqXlj6Pop4TojIPjgIJcbiAqXG4gKiBAYXV0aG9yICAgIOWnmuWwpyA8eWFvZ2FveXVAcXEuY29tPlxuICogQGZpbGUgICAgICBDb3JlL19SdW50aW1lL0lDb25maWdVc2VyRmxvdy50c1xuICovXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiSVN0ZXBGbG93LnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9fVmlldy9JVmlldy50c1wiIC8+XG4vKipcbiAqIOeUn+aIkOeUqOaIt+S4muWKoea1geOAglxuICpcbiAqIEBhdXRob3IgICAg5aea5bCnIDx5YW9nYW95dUBxcS5jb20+XG4gKiBAZmlsZSAgICAgIFJ1bnRpbWUvQ29uZmlnVXNlckZsb3cudHNcbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL0Zsb3cudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL0NvcmUvX1J1bnRpbWUvSUNvbmZpZ1VzZXJGbG93LnRzXCIgLz5cbnZhciBSdW50aW1lO1xuKGZ1bmN0aW9uIChSdW50aW1lKSB7XG4gICAgdmFyIENvbmZpZ1VzZXJGbG93ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKENvbmZpZ1VzZXJGbG93LCBfc3VwZXIpO1xuICAgICAgICAvKipcbiAgICAgICAgICog5p6E6YCg5Ye95pWw44CCXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBDb25maWdVc2VyRmxvdyhjb25maWcpIHtcbiAgICAgICAgICAgIF9zdXBlci5jYWxsKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiDnlJ/miJDnlKjmiLdcbiAgICAgICAgICovXG4gICAgICAgIENvbmZpZ1VzZXJGbG93LnByb3RvdHlwZS5nZW5Vc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy9cbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOatpemqpOmqjOivgVxuICAgICAgICAgKi9cbiAgICAgICAgQ29uZmlnVXNlckZsb3cucHJvdG90eXBlLnZhbGlkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBDb25maWdVc2VyRmxvdztcbiAgICB9KFJ1bnRpbWUuRmxvdykpO1xuICAgIFJ1bnRpbWUuQ29uZmlnVXNlckZsb3cgPSBDb25maWdVc2VyRmxvdztcbn0pKFJ1bnRpbWUgfHwgKFJ1bnRpbWUgPSB7fSkpO1xuLyoqXG4gKiDlo7DmmI7phY3nva7lrozmiJDlrozmiJDkuJrliqHmtYHmjqXlj6Pop4TojIPjgIJcbiAqXG4gKiBAYXV0aG9yICAgIOWnmuWwpyA8eWFvZ2FveXVAcXEuY29tPlxuICogQGZpbGUgICAgICBDb3JlL19SdW50aW1lL0lGaW5pc2hGbG93LnRzXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJJU3RlcEZsb3cudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL19WaWV3L0lWaWV3LnRzXCIgLz5cbi8qKlxuICog6YWN572u5a6M5oiQ5a6e5L2T44CCXG4gKlxuICogQGF1dGhvciAgICDlp5rlsKcgPHlhb2dhb3l1QHFxLmNvbT5cbiAqIEBmaWxlICAgICAgUnVudGltZS9GaW5pc2hGbG93LnRzXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9GbG93LnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi9Db3JlL19SdW50aW1lL0lGaW5pc2hGbG93LnRzXCIgLz5cbnZhciBSdW50aW1lO1xuKGZ1bmN0aW9uIChSdW50aW1lKSB7XG4gICAgdmFyIEZpbmlzaEZsb3cgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoRmluaXNoRmxvdywgX3N1cGVyKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOaehOmAoOWHveaVsOOAglxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gRmluaXNoRmxvdyhjb25maWcpIHtcbiAgICAgICAgICAgIF9zdXBlci5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiDpobnnm67kuIrkuIvmlodcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdGhpcy5jb250ZXh0UGF0aCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcFwiKS5nZXRBdHRyaWJ1dGUoXCJyZWZcIik7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIOW8ueWHuuahhumFjee9rlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB0aGlzLmFsZXJ0Q29uZiA9IHtcbiAgICAgICAgICAgICAgICBjYW5jZWw6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRpdGxlOiAn5o+Q56S6JyxcbiAgICAgICAgICAgICAgICBva1ZhbHVlOiAn56Gu5a6aJyxcbiAgICAgICAgICAgICAgICBvazogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIOaPkOekuuahhumFjee9rlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB0aGlzLnByb21wdENvbmYgPSB7XG4gICAgICAgICAgICAgICAgY2FuY2VsOiBmYWxzZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMud2l6Q29uZmlnID0gY29uZmlnO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiDlpITnkIbphY3nva7lrozmiJDkuJrliqFcbiAgICAgICAgICovXG4gICAgICAgIEZpbmlzaEZsb3cucHJvdG90eXBlLmZpbmlzaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAvLyBsZXQgYWxlcnQ6IGFueSA9IGRpYWxvZyh0aGlzLmFsZXJ0Q29uZik7XG4gICAgICAgICAgICB2YXIgcHJvbXB0ID0gZGlhbG9nKHRoaXMucHJvbXB0Q29uZik7XG4gICAgICAgICAgICBwcm9tcHQuY29udGVudChcIjxzcGFuIGNsYXNzPSdjb2wgbG9hZGluZyc+6K+356iN5YCZ77yM5q2j5Zyo55Sf5oiQ5ZCM5q2l5bel5YW357O757uf6K6+572u44CCPC9zcGFuPjxpbWcgY2xhc3M9J2NvbCBsb2FkaW5nJyBzcmM9J1wiICsgdGhpcy5jb250ZXh0UGF0aCArIFwiL3MvaW1hZ2VzL2xvYWRpbmcuZ2lmJz5cIik7XG4gICAgICAgICAgICBwcm9tcHQuc2hvd01vZGFsKCk7XG4gICAgICAgICAgICBVdGlsLlJlbW90ZS5wb3N0KHRoaXMuY29udGV4dFBhdGggKyBcIi93aXphcmQvc2F2ZVwiLCB0aGlzLndpekNvbmZpZywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgaXNXaXpTdWMgPSBkYXRhWydjb2RlJ10gIT0gXCIwXCI7XG4gICAgICAgICAgICAgICAgcHJvbXB0LmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgaWYgKGlzV2l6U3VjKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhbGVydERpYWxvZ18xO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5hbGVydENvbmZbJ29rJ10gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWxlcnREaWFsb2dfMSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydERpYWxvZ18xLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy52aWV3LnByb3BzLnBhcmVudEZsb3cuZGlzcGF0Y2hFdmVudChuZXcgRXYuU3RlcCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBfdGhpcy52aWV3LnByb3BzLnBhcmVudEZsb3csXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJmaW5pc2hcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBhbGVydERpYWxvZ18xID0gZGlhbG9nKF90aGlzLmFsZXJ0Q29uZik7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0RGlhbG9nXzEuY29udGVudChcIjxzcGFuIGNsYXNzPSdhbGVydCc+PHNwYW4gY2xhc3M9J2ljb24gaWNvbi1jaGVja21hcmsnPjwvc3Bhbj48c3BhbiBjbGFzcz0ndGl0bGUnPumFjee9ruaIkOWKn+OAgjwvc3Bhbj5cIik7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0RGlhbG9nXzEuc2hvd01vZGFsKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgbnVsbCk7XG4gICAgICAgIH07XG4gICAgICAgIC8qKlxuICAgICAgICAgKiDmraXpqqTpqozor4FcbiAgICAgICAgICovXG4gICAgICAgIEZpbmlzaEZsb3cucHJvdG90eXBlLnZhbGlkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBGaW5pc2hGbG93O1xuICAgIH0oUnVudGltZS5GbG93KSk7XG4gICAgUnVudGltZS5GaW5pc2hGbG93ID0gRmluaXNoRmxvdztcbn0pKFJ1bnRpbWUgfHwgKFJ1bnRpbWUgPSB7fSkpO1xuLyoqXG4gKiDlkJHlr7zkuJrliqHmtYHlrp7kvZPjgIJcbiAqXG4gKiBAYXV0aG9yICAgIOWnmuWwpyA8eWFvZ2FveXVAcXEuY29tPlxuICogQGZpbGUgICAgICBSdW50aW1lL1N0YWdlLnRzXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJGbG93LnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9WaWV3L1N0YWdlLnRzeFwiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vQ29yZS9fUnVudGltZS9JU3RhZ2VGbG93LnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJfU3RlcHMvTm9kZUNob2ljZUZsb3cudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIl9TdGVwcy9Db25maWdEQkZsb3cudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIl9TdGVwcy9SZWdpc3RlSW5mb0Zsb3cudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIl9TdGVwcy9Db25maWdVc2VyRmxvdy50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiX1N0ZXBzL0ZpbmlzaEZsb3cudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL0V2L1N0ZXAudHNcIiAvPlxudmFyIFJ1bnRpbWU7XG4oZnVuY3Rpb24gKFJ1bnRpbWUpIHtcbiAgICB2YXIgU3RhZ2VGbG93ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFN0YWdlRmxvdywgX3N1cGVyKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOaehOmAoOWHveaVsOOAglxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gU3RhZ2VGbG93KGNvbnRhaW5lcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIF9zdXBlci5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiB0eXBlIOiKgueCueexu+Wei1xuICAgICAgICAgICAgICogZGIuZHJpdmVyXG4gICAgICAgICAgICAgKiBkYi51cmxcbiAgICAgICAgICAgICAqIGRiLnVzZXJcbiAgICAgICAgICAgICAqIGRiLnBzd1xuICAgICAgICAgICAgICogcmVnaXN0cmF0aW9uLnVybFxuICAgICAgICAgICAgICogc3luYy51cmxcbiAgICAgICAgICAgICAqIHVzZXJcbiAgICAgICAgICAgICAqIHBzd1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB0aGlzLmNvbmZpZ0RhdGFzID0ge307XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIOWtkOinhuWbvuWvueW6lOS4muWKoea1geWunuS9k+WTiOW4jOihqFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB0aGlzLnN1YlZpZXdGbG93SGFzaCA9IHt9O1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiDlvZPliY3miYDlnKjmraXpqqTnmoTntKLlvJXlj7dcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdGhpcy5zdGVwSW5kZXggPSAwO1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiDmraXpqqTpobrluo9cbiAgICAgICAgICAgICAqIFwibm9kZUNob2ljZVwiLCBcImNvbmZpZ0RCXCIsIFwicmVnaXN0ZUluZm9cIiwgXCJjb25maWdVc2VyXCIsIFwiZmluaXNoXCJcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdGhpcy5zdGVwT3JkZXIgPSBbXCJub2RlQ2hvaWNlXCIsIFwiY29uZmlnREJcIiwgXCJyZWdpc3RlSW5mb1wiLCBcImZpbmlzaFwiXTtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICog6aG555uu5LiK5LiL5paHXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHRoaXMuY29udGV4dFBhdGggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BcIikuZ2V0QXR0cmlidXRlKFwicmVmXCIpO1xuICAgICAgICAgICAgdGhpcy52aWV3ID0gUmVhY3QucmVuZGVyKFJlYWN0LmNyZWF0ZUVsZW1lbnQoVmlldy5TdGFnZSwge2Zsb3c6IHRoaXN9KSwgY29udGFpbmVyKTtcbiAgICAgICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcihcInN0ZXBcIiwgZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgICAgICAgICAgaWYgKGV2LnR5cGUgPT0gXCJkYi5uZXh0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuY29uZmlnREJOZXh0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV2LnR5cGUgPT0gXCJmaW5pc2hcIikge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5maW5pc2goKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICog5Y+W5b6X6YWN572u5pWw5o2u44CCXG4gICAgICAgICAqL1xuICAgICAgICBTdGFnZUZsb3cucHJvdG90eXBlLmdDb25maWcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb25maWdEYXRhcztcbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOe7keWumuWtkOinhuWbvuS4jkZsb3fjgIJcbiAgICAgICAgICovXG4gICAgICAgIFN0YWdlRmxvdy5wcm90b3R5cGUubWFrZSA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5zdWJWaWV3Rmxvd0hhc2ggJiYgdHlwZSBpbiB0aGlzLnN1YlZpZXdGbG93SGFzaClcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zdWJWaWV3Rmxvd0hhc2hbdHlwZV07XG4gICAgICAgICAgICB2YXIgZmxvdztcbiAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ25vZGVDaG9pY2UnOlxuICAgICAgICAgICAgICAgICAgICBmbG93ID0gbmV3IFJ1bnRpbWUuTm9kZUNob2ljZUZsb3codGhpcy5jb25maWdEYXRhcyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2NvbmZpZ0RCJzpcbiAgICAgICAgICAgICAgICAgICAgZmxvdyA9IG5ldyBSdW50aW1lLkNvbmZpZ0RCRmxvdyh0aGlzLmNvbmZpZ0RhdGFzKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAncmVnaXN0ZUluZm8nOlxuICAgICAgICAgICAgICAgICAgICBmbG93ID0gbmV3IFJ1bnRpbWUuUmVnaXN0ZUluZm9GbG93KHRoaXMuY29uZmlnRGF0YXMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdjb25maWdVc2VyJzpcbiAgICAgICAgICAgICAgICAgICAgZmxvdyA9IG5ldyBSdW50aW1lLkNvbmZpZ1VzZXJGbG93KHRoaXMuY29uZmlnRGF0YXMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdmaW5pc2gnOlxuICAgICAgICAgICAgICAgICAgICBmbG93ID0gbmV3IFJ1bnRpbWUuRmluaXNoRmxvdyh0aGlzLmNvbmZpZ0RhdGFzKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnN1YlZpZXdGbG93SGFzaFt0eXBlXSA9IGZsb3c7XG4gICAgICAgICAgICByZXR1cm4gZmxvdztcbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOWPluW+l+W9k+WJjeatpemqpOe0ouW8leWPt+OAglxuICAgICAgICAgKiDntKLlvJXlj7fku44w5byA5aeLXG4gICAgICAgICAqL1xuICAgICAgICBTdGFnZUZsb3cucHJvdG90eXBlLmdTdGVwSW5kZXggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdGVwSW5kZXg7XG4gICAgICAgIH07XG4gICAgICAgIC8qKlxuICAgICAgICAgKiDorr7nva7lvZPliY3mraXpqqTntKLlvJXlj7fjgIJcbiAgICAgICAgICog57Si5byV5Y+35LuOMOW8gOWni1xuICAgICAgICAgKi9cbiAgICAgICAgU3RhZ2VGbG93LnByb3RvdHlwZS5zU3RlcEluZGV4ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICBpZiAoaW5kZXggPCAwKVxuICAgICAgICAgICAgICAgIHRoaXMuc3RlcEluZGV4ID0gMDtcbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOS4iuS4gOatpeOAglxuICAgICAgICAgKi9cbiAgICAgICAgU3RhZ2VGbG93LnByb3RvdHlwZS5wcmV2aW91cyA9IGZ1bmN0aW9uIChldikge1xuICAgICAgICAgICAgaWYgKHRoaXMuc3RlcEluZGV4IDw9IDApXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgdGhpcy5zdGVwSW5kZXggLT0gMTtcbiAgICAgICAgICAgIHRoaXMudmlldy5mb3JjZVVwZGF0ZSgpO1xuICAgICAgICB9O1xuICAgICAgICAvKipcbiAgICAgICAgICog5LiL5LiA5q2l44CCXG4gICAgICAgICAqL1xuICAgICAgICBTdGFnZUZsb3cucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgICAgIHZhciBzdGVwRmxvdyA9IHRoaXMubWFrZSh0aGlzLnN0ZXBPcmRlclt0aGlzLnN0ZXBJbmRleF0pO1xuICAgICAgICAgICAgaWYgKHRoaXMuc3RlcEluZGV4ID09IDEpIHtcbiAgICAgICAgICAgICAgICBzdGVwRmxvdy52YWxpZGF0ZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnN0ZXBJbmRleCA8IHRoaXMuc3RlcE9yZGVyLmxlbmd0aCAtIDEgJiYgc3RlcEZsb3cudmFsaWRhdGUoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RlcEluZGV4ICs9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnZpZXcuZm9yY2VVcGRhdGUoKTtcbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOWujOaIkOOAglxuICAgICAgICAgKi9cbiAgICAgICAgU3RhZ2VGbG93LnByb3RvdHlwZS5maW5pc2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFV0aWwuUGF0aC5nT3JpZ2luKCk7XG4gICAgICAgIH07XG4gICAgICAgIC8qKlxuICAgICAgICAgKiDmtYvor5XmlbDmja7lupPov57mjqVcbiAgICAgICAgICovXG4gICAgICAgIFN0YWdlRmxvdy5wcm90b3R5cGUuY29ublRlc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIGRiVHlwZSA9IHRoaXMuY29uZmlnRGF0YXNbJ2RiLnR5cGUnXTtcbiAgICAgICAgICAgIHZhciBkYkRyaXZlciA9IHRoaXMuY29uZmlnRGF0YXNbJ2RiLmRyaXZlciddO1xuICAgICAgICAgICAgdmFyIGRiVXJsID0gdGhpcy5jb25maWdEYXRhc1snZGIudXJsJ107XG4gICAgICAgICAgICB2YXIgZGJVc2VyID0gdGhpcy5jb25maWdEYXRhc1snZGIudXNlciddO1xuICAgICAgICAgICAgdmFyIGRiUHN3ID0gdGhpcy5jb25maWdEYXRhc1snZGIucHN3J107XG4gICAgICAgICAgICBpZiAoIWRiVHlwZSB8fCAhZGJEcml2ZXIgfHwgIWRiVXJsIHx8ICFkYlVzZXIgfHwgIWRiUHN3KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZmFsc2UpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHRlc3REYXRhID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6IGRiVHlwZSB8fCAnJyxcbiAgICAgICAgICAgICAgICBkcml2ZXI6IGRiRHJpdmVyIHx8ICcnLFxuICAgICAgICAgICAgICAgIHVybDogZGJVcmwgfHwgJycsXG4gICAgICAgICAgICAgICAgdTogZGJVc2VyIHx8ICcnLFxuICAgICAgICAgICAgICAgIHA6IGRiUHN3IHx8ICcnXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICAgICAgICAgVXRpbC5SZW1vdGUucG9zdChfdGhpcy5jb250ZXh0UGF0aCArIFwiL3dpemFyZC90ZXN0Q29ublwiLCB0ZXN0RGF0YSwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhW1wiY29kZVwiXSA9PSBcIjFcIik7XG4gICAgICAgICAgICAgICAgfSwgbnVsbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOaVsOaNruW6k+mFjee9rueahOS4i+S4gOatpeeUseaVsOaNruW6k+mFjee9ruS4muWKoeiHquW3seiwg+eUqFxuICAgICAgICAgKi9cbiAgICAgICAgU3RhZ2VGbG93LnByb3RvdHlwZS5jb25maWdEQk5leHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnN0ZXBJbmRleCArPSAxO1xuICAgICAgICAgICAgdGhpcy52aWV3LmZvcmNlVXBkYXRlKCk7XG4gICAgICAgIH07XG4gICAgICAgIC8qKlxuICAgICAgICAgKiDlvJXmk47lkI1cbiAgICAgICAgICovXG4gICAgICAgIFN0YWdlRmxvdy5FTkdJTkVfTkFNRSA9IFwiZGJ0b29sXCI7XG4gICAgICAgIHJldHVybiBTdGFnZUZsb3c7XG4gICAgfShSdW50aW1lLkZsb3cpKTtcbiAgICBSdW50aW1lLlN0YWdlRmxvdyA9IFN0YWdlRmxvdztcbn0pKFJ1bnRpbWUgfHwgKFJ1bnRpbWUgPSB7fSkpO1xuLyoqXG4gKiDlkJHlr7zov5DooYzml7blrp7kvZPjgIJcbiAqXG4gKiBAYXV0aG9yICAgIOWnmuWwpyA8eWFvZ2FveXVAcXEuY29tPlxuICogQGZpbGUgICAgICBSdW50aW1lL1J1bnRpbWUudHNcbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIlN0YWdlRmxvdy50c3hcIiAvPlxudmFyIFJ1bnRpbWU7XG4oZnVuY3Rpb24gKFJ1bnRpbWVfMSkge1xuICAgIHZhciBSdW50aW1lID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOaehOmAoOWHveaVsOOAglxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gUnVudGltZSgpIHtcbiAgICAgICAgICAgIHZhciBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud2l6YXJkJyk7XG4gICAgICAgICAgICB0aGlzLnN0YWdlID0gbmV3IFJ1bnRpbWVfMS5TdGFnZUZsb3coY29udGFpbmVyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUnVudGltZTtcbiAgICB9KCkpO1xuICAgIFJ1bnRpbWVfMS5SdW50aW1lID0gUnVudGltZTtcbn0pKFJ1bnRpbWUgfHwgKFJ1bnRpbWUgPSB7fSkpO1xuLyoqXG4gKiDlkIzmraXlt6XlhbfphY3nva7lkJHlr7zlhaXlj6PnsbvjgIJcbiAqXG4gKiBAYXV0aG9yICAgIOWnmuWwpyA8eWFvZ2FveXVAMTYzLmNvbT5cbiAqIEBmaWxlICAgICAgV2l6YXJkLnRzXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJSdW50aW1lL1J1bnRpbWUudHNcIiAvPlxudmFyIFdpemFyZCA9IChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICog5p6E6YCg5Ye95pWw44CCXG4gICAgICovXG4gICAgZnVuY3Rpb24gV2l6YXJkKCkge1xuICAgICAgICB0aGlzLnJ1bnRpbWUgPSBuZXcgUnVudGltZS5SdW50aW1lKCk7XG4gICAgfVxuICAgIFdpemFyZC52ZXJzaW9uID0gXCIwLjEuMFwiO1xuICAgIHJldHVybiBXaXphcmQ7XG59KCkpO1xubW9kdWxlLmV4cG9ydHM9V2l6YXJkO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9d2l6YXJkLmpzLm1hcFxuIl19
